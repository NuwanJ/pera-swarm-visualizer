{"version":3,"sources":["webpack:///./src/js/data/config.js","webpack:///./src/js/utils/detector.js","webpack:///./src/js/app/components/renderer.js","webpack:///./src/js/app/components/label.js","webpack:///./src/js/app/components/camera.js","webpack:///./src/js/app/components/light.js","webpack:///./src/js/app/components/controls.js","webpack:///./src/js/app/components/environment.js","webpack:///./src/js/app/helpers/vertexNormalsHelper.js","webpack:///./src/js/app/helpers/meshHelper.js","webpack:///./src/js/utils/helpers.js","webpack:///./src/js/app/model/texture.js","webpack:///./src/js/app/loaders/GLTFLoader.js","webpack:///./src/js/utils/keyboard.js","webpack:///./src/js/app/managers/interaction.js","webpack:///./src/js/app/managers/datGUI.js","webpack:///./src/js/app/components/obstacle.js","webpack:///./src/js/app/components/robot.js","webpack:///./src/js/app/managers/mqttClient.js","webpack:///./src/js/app/main.js","webpack:///./src/js/app.js"],"names":["scale","arena","size","minX","maxX","minY","maxY","mqtt","server","port","path","user","password","channel","mixedReality","obstacles","robots","selectedReality","isDev","isShowingStats","isShowingLables","labelsVisibility","isShowingRobotSnapshots","isLoaded","isTweening","isRotating","isMouseMoving","isMouseOver","maxAnisotropy","dpr","easing","TWEEN","Easing","Quadratic","InOut","duration","texture","imageFiles","name","image","mesh","enableHelper","wireframe","translucent","material","color","emissive","fog","near","camera","fov","far","aspect","posX","posY","posZ","controls","autoRotate","autoRotateSpeed","rotateSpeed","zoomSpeed","minDistance","maxDistance","minPolarAngle","maxPolarAngle","Math","PI","minAzimuthAngle","Infinity","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","target","x","y","z","ambientLight","enabled","directionalLight","intensity","shadow","helperEnabled","bias","mapWidth","mapHeight","top","right","bottom","left","pointLight","distance","hemiLight","groundColor","canvas","window","CanvasRenderingContext2D","webgl","document","createElement","WebGLRenderingContext","getContext","e","workers","Worker","fileapi","File","FileReader","FileList","Blob","getWebGLErrorMessage","element","id","style","fontFamily","fontSize","fontWeight","textAlign","background","padding","width","margin","this","innerHTML","join","addGetWebGLMessage","parameters","parent","undefined","body","appendChild","Renderer","scene","container","threeRenderer","THREE","antialias","setClearColor","setPixelRatio","devicePixelRatio","domElement","shadowMap","type","Config","capabilities","getMaxAnisotropy","updateSize","addEventListener","setSize","offsetWidth","offsetHeight","render","addLabel","prefix","object","visibility","className","textContent","marginTop","elementLabel","CSS2DObject","position","set","visible","add","removeLabel","remove","Camera","renderer","height","threeCamera","up","updateProjectionMatrix","Light","init","castShadow","mapSize","directionalLightHelper","lightName","Controls","threeControls","OrbitControls","enableRotate","Environment","console","log","scene_scale","geometry","depthWrite","userData","originalColor","ground","receiveShadow","grid","rotation","opacity","transparent","_v1","Vector3","_v2","_normalMatrix","Matrix3","_keys","VertexNormalsHelper","hex","nNormals","objGeometry","isGeometry","faces","length","isBufferGeometry","attributes","normal","count","BufferGeometry","positions","Float32BufferAttribute","setAttribute","LineSegments","call","LineBasicMaterial","toneMapped","matrixAutoUpdate","update","prototype","Object","create","constructor","idx","updateMatrixWorld","getNormalMatrix","matrixWorld","vertices","i","l","face","j","jl","vertexNormals","vertex","copy","applyMatrix4","applyMatrix3","normalize","multiplyScalar","setXYZ","objPos","objNorm","getX","getY","getZ","needsUpdate","MeshHelper","wireLine","depthTest","edges","edgesLine","vertexHelper","boxHelper","Helpers","fn","threshhold","scope","last","deferTimer","context","now","Date","args","arguments","clearTimeout","setTimeout","apply","xhr","lengthComputable","percentComplete","loaded","total","round","error","value","replace","setHex","shading","vertexColors","side","verticesNeedUpdate","normalsNeedUpdate","colorsNeedUpdate","materialKey","textures","key","Texture","loader","promiseArray","setPath","forEach","imageFile","push","Promise","resolve","reject","load","anisotropy","modelOBJ","logProgress","Error","all","then","keys","reason","GLTFLoader","manager","Loader","dracoLoader","ddsLoader","GLTFRegistry","objects","get","removeAll","assign","url","onLoad","onProgress","onError","resourcePath","LoaderUtils","extractUrlBase","itemStart","_onError","itemError","itemEnd","FileLoader","setResponseType","crossOrigin","setWithCredentials","data","parse","gltf","setDRACOLoader","setDDSLoader","content","extensions","decodeText","Uint8Array","BINARY_EXTENSION_HEADER_MAGIC","EXTENSIONS","KHR_BINARY_GLTF","GLTFBinaryExtension","json","JSON","asset","version","extensionsUsed","extensionName","extensionsRequired","KHR_LIGHTS_PUNCTUAL","GLTFLightsExtension","KHR_MATERIALS_CLEARCOAT","GLTFMaterialsClearcoatExtension","KHR_MATERIALS_UNLIT","GLTFMaterialsUnlitExtension","KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS","GLTFMaterialsPbrSpecularGlossinessExtension","KHR_DRACO_MESH_COMPRESSION","GLTFDracoMeshCompressionExtension","MSFT_TEXTURE_DDS","GLTFTextureDDSExtension","KHR_TEXTURE_TRANSFORM","GLTFTextureTransformExtension","KHR_MESH_QUANTIZATION","GLTFMeshQuantizationExtension","indexOf","warn","GLTFParser","extension","lightDefs","lights","loadLight","lightIndex","lightNode","lightDef","Color","fromArray","range","DirectionalLight","PointLight","SpotLight","spot","innerConeAngle","outerConeAngle","angle","penumbra","decay","getMaterialType","MeshBasicMaterial","extendParams","materialParams","materialDef","parser","pending","metallicRoughness","pbrMetallicRoughness","Array","isArray","baseColorFactor","array","baseColorTexture","assignTexture","MeshPhysicalMaterial","clearcoatFactor","clearcoat","clearcoatTexture","clearcoatRoughnessFactor","clearcoatRoughness","clearcoatRoughnessTexture","clearcoatNormalTexture","clearcoatNormalScale","Vector2","BINARY_EXTENSION_CHUNK_TYPES","headerView","DataView","header","magic","slice","getUint32","chunkView","chunkIndex","byteLength","chunkLength","chunkType","contentArray","byteOffset","preload","GLTFMeshStandardSGMaterial","params","MeshStandardMaterial","isGLTFSpecularGlossinessMaterial","specularMapParsFragmentChunk","glossinessMapParsFragmentChunk","specularMapFragmentChunk","glossinessMapFragmentChunk","lightPhysicalFragmentChunk","uniforms","specular","glossiness","specularMap","glossinessMap","_extraUniforms","onBeforeCompile","shader","uniformName","fragmentShader","defineProperties","v","defines","USE_GLOSSINESSMAP","USE_ROUGHNESSMAP","metalness","roughness","metalnessMap","roughnessMap","setValues","specularGlossinessParams","pbrSpecularGlossiness","diffuseFactor","diffuseTexture","glossinessFactor","specularFactor","specularGlossinessTexture","specGlossMapDef","createMaterial","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","TangentSpaceNormalMap","normalScale","displacementMap","displacementScale","displacementBias","alphaMap","envMap","envMapIntensity","refractionRatio","GLTFCubicSplineInterpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","Interpolant","decodePrimitive","primitive","bufferViewIndex","bufferView","gltfAttributeMap","threeAttributeMap","attributeNormalizedMap","attributeTypeMap","attributeName","threeAttributeName","ATTRIBUTES","toLowerCase","accessorDef","accessors","componentType","WEBGL_COMPONENT_TYPES","normalized","getDependency","decodeDracoFile","attribute","extendTexture","transform","clone","offset","repeat","texCoord","source","copySampleValue_","index","result","values","valueSize","beforeStart_","afterEnd_","interpolate_","i1","t0","t","t1","stride","stride2","stride3","td","p","pp","ppp","offset1","offset0","s2","s3","s0","s1","p0","m0","p1","m1","WEBGL_CONSTANTS","5120","Int8Array","5121","5122","Int16Array","5123","Uint16Array","5125","Uint32Array","5126","Float32Array","WEBGL_FILTERS","9728","NearestFilter","9729","LinearFilter","9984","NearestMipmapNearestFilter","9985","LinearMipmapNearestFilter","9986","NearestMipmapLinearFilter","9987","LinearMipmapLinearFilter","WEBGL_WRAPPINGS","33071","ClampToEdgeWrapping","33648","MirroredRepeatWrapping","10497","RepeatWrapping","WEBGL_TYPE_SIZES","SCALAR","VEC2","VEC3","VEC4","MAT2","MAT3","MAT4","POSITION","NORMAL","TANGENT","TEXCOORD_0","TEXCOORD_1","COLOR_0","WEIGHTS_0","JOINTS_0","PATH_PROPERTIES","translation","weights","INTERPOLATION","CUBICSPLINE","LINEAR","InterpolateLinear","STEP","InterpolateDiscrete","ALPHA_MODES","MIME_TYPE_FORMATS","RGBAFormat","RGBFormat","resolveURL","test","addUnknownExtensionsToUserData","knownExtensions","objectDef","gltfExtensions","assignExtrasToUserData","gltfDef","extras","updateMorphTargets","meshDef","il","morphTargetInfluences","targetNames","morphTargetDictionary","createAttributesKey","attributesKey","sort","options","cache","primitiveCache","textureLoader","TextureLoader","setCrossOrigin","fileLoader","addPrimitiveAttributes","primitiveDef","assignAttributeAccessor","accessorIndex","accessor","gltfAttributeName","indices","setIndex","box","Box3","min","max","targets","maxDisplacement","vector","setX","abs","setY","setZ","expandByVector","boundingBox","sphere","Sphere","getCenter","center","radius","distanceTo","boundingSphere","computeBounds","hasMorphPosition","hasMorphNormal","pendingPositionAccessors","pendingNormalAccessors","pendingAccessor","morphPositions","morphNormals","morphAttributes","morphTargetsRelative","addMorphTargets","toTrianglesDrawMode","drawMode","getIndex","getAttribute","numberOfTriangles","newIndices","TriangleFanDrawMode","newGeometry","markDefs","getDependencies","dependencies","scenes","animations","cameras","nodeDefs","nodes","skinDefs","skins","meshDefs","meshes","meshReferences","meshUses","skinIndex","skinLength","joints","isBone","nodeIndex","nodeLength","nodeDef","skin","isSkinnedMesh","cacheKey","dependency","loadScene","loadNode","loadMesh","loadAccessor","loadBufferView","loadBuffer","loadMaterial","loadTexture","loadSkin","loadAnimation","loadCamera","defs","def","bufferIndex","bufferDef","buffers","uri","bufferViewDef","bufferViews","buffer","sparse","pendingBufferViews","bufferAttribute","itemSize","TypedArray","elementBytes","BYTES_PER_ELEMENT","itemBytes","byteStride","ibSlice","floor","ibCacheKey","ib","InterleavedBuffer","InterleavedBufferAttribute","BufferAttribute","itemSizeIndices","TypedArrayIndices","byteOffsetIndices","byteOffsetValues","sparseIndices","sparseValues","setW","textureIndex","URL","self","webkitURL","textureDef","textureExtensions","sourceURI","images","isObjectURL","blob","mimeType","createObjectURL","getHandler","revokeObjectURL","flipY","format","sampler","samplers","magFilter","minFilter","wrapS","wrapT","mapName","mapDef","isCompressedTexture","assignFinalMaterial","useVertexTangents","tangent","useVertexColors","useFlatShading","useSkinning","useMorphTargets","useMorphNormals","isPoints","uuid","pointsMaterial","PointsMaterial","Material","sizeAttenuation","isLine","lineMaterial","cachedMaterial","skinning","vertexTangents","flatShading","morphTargets","uv2","uv","materialIndex","materialType","materials","materialExtensions","sgExtension","kmuExtension","metallicFactor","roughnessFactor","metallicRoughnessTexture","doubleSided","DoubleSide","alphaMode","alphaTest","alphaCutoff","normalTexture","occlusionTexture","strength","emissiveFactor","emissiveTexture","clearcoatExtension","encoding","sRGBEncoding","loadGeometries","primitives","createDracoPrimitive","dracoExtension","geometryPromise","mode","cached","promise","meshIndex","FrontSide","results","geometries","SkinnedMesh","Mesh","skinWeight","normalizeSkinWeights","TriangleStripDrawMode","Line","LineLoop","Points","group","Group","cameraIndex","cameraDef","PerspectiveCamera","MathUtils","radToDeg","yfov","aspectRatio","znear","zfar","OrthographicCamera","xmag","ymag","skinDef","skinEntry","inverseBindMatrices","animationIndex","animationDef","pendingNodes","pendingInputAccessors","pendingOutputAccessors","pendingSamplers","pendingTargets","channels","node","input","output","inputAccessors","outputAccessors","tracks","inputAccessor","outputAccessor","TypedKeyframeTrack","updateMatrix","NumberKeyframeTrack","QuaternionKeyframeTrack","VectorKeyframeTrack","targetName","interpolation","traverse","isMesh","outputArray","scaled","track","createInterpolant","times","getValueSize","isInterpolantFactoryMethodGLTFCubicSpline","AnimationClip","instanceNum","o","light","Bone","Object3D","PropertyBinding","sanitizeNodeName","matrix","Matrix4","quaternion","buildNodeHierachy","nodeId","parentObject","pendingJoints","jointNodes","bones","boneInverses","jointNode","mat","bind","Skeleton","children","child","sceneIndex","sceneDef","nodeIds","ALIAS","down","space","tab","escape","Keyboard","keyCodes","event","onKeyChange","onBlur","removeEventListener","prop","keyCode","keyDesc","split","pressed","toUpperCase","charCodeAt","aliases","aliasKeys","shiftKey","ctrlKey","altKey","metaKey","Interaction","timeout","keyboard","throttle","onMouseMove","onMouseLeave","onMouseOver","eventMatches","preventDefault","storedConfig","localStorage","getItem","location","href","realities","physical","virtual","DatGUI","main","gui","dat","GUI","useLocalStorage","model","meshHelper","labelsFolder","addFolder","onChange","toggleLabels","realityFolder","listen","toggleReality","open","variable","startsWith","reality","selected","attrib","entries","obj","show","destroy","Obstacle","callback","obs","obstacle","createGeometry","labelVisibility","originalEmmisive","getHex","random","deleteIfExists","calculateZ","radX","radY","radZ","g","TypeError","createBoxGeometry","depth","createCylinderGeometry","radiusTop","radiusBottom","createSphereGeometry","heightSegments","radialSegments","widthSegments","m","properties","getObjectByName","STLLoader","require","Robot","R","G","B","ambient","r","setRGB","heading","REALITY","robotId","DEG2RAD","clickEvent","robot","alert","setReality","move","currentHeading","newHeading","rotationFlag","sqrt","pow","Tween","to","onUpdate","onComplete","delay","start","publish","stringify","disp","querySelector","display","requestSnapshot","MQTTClient","updateChannel","client_id","toString","substring","client","MQTT","Client","connect","userName","reconnect","useSSL","cleanSession","onSuccess","subscribe","onMessageArrived","onConnectionLost","onFailure","channelHash","hash","responseObject","errorCode","errorMessage","packet","msg","payloadString","trim","destinationName","topic","exists","createList","deleteAll","changeColor","reload","snapshot","coordinates","subTopic","message","payload","Message","pubTopic","send","INTERSECTED","selectedLabel","raycaster","mouse","Main","clock","place","stats","Stats","dom","labelRenderer","CSS2DRenderer","innerWidth","innerHeight","isShowingObstacleLables","isShowingRobotLables","environment","item","enable","onDocumentMouseDown","clientX","clientY","setFromCamera","intersects","intersectObjects","currentOpacity","currentHex","currentColor","hidden","requestAnimationFrame","Detector","getElementById"],"mappings":"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","file":"0.app.js","sourcesContent":["import TWEEN from '@tweenjs/tween.js';\n\n// This object contains the state of the app\nexport default {\n    scale: 1,\n    arena: {\n        size: 300,\n        minX: -140,\n        maxX: 140,\n        minY: -140,\n        maxY: 140\n    },\n    mqtt: {\n        server: 'swarm-gui.tk',\n        port: 8883,\n        path: '/socket.io',\n        user: 'swarm_user',\n        password: 'swarm_usere15',\n        channel: 'v1'\n    },\n    mixedReality: {\n        obstacles: 'M',\n        robots: 'M'\n    },\n    selectedReality: 'M',\n    isDev: true,\n    isShowingStats: true,\n    isShowingLables: true,\n    labelsVisibility: {\n        obstacles: false,\n        robots: true\n    },\n    isShowingRobotSnapshots: true,\n    isLoaded: false,\n    isTweening: false,\n    isRotating: false,\n    isMouseMoving: false,\n    isMouseOver: false,\n    maxAnisotropy: 1,\n    dpr: 1,\n    easing: TWEEN.Easing.Quadratic.InOut,\n    duration: 500,\n    texture: {\n        path: './assets/textures/',\n        imageFiles: [{ name: 'UV', image: 'UV_Grid_Sm.jpg' }]\n    },\n    mesh: {\n        enableHelper: false,\n        wireframe: false,\n        translucent: false,\n        material: {\n            color: 0xffffff,\n            emissive: 0xffffff\n        }\n    },\n    fog: {\n        color: 0xffffff,\n        near: 0.0008\n    },\n    camera: {\n        fov: 50,\n        near: 50,\n        far: 1000,\n        aspect: 1,\n        posX: 0,\n        posY: 0,\n        posZ: 0\n    },\n    controls: {\n        autoRotate: false,\n        autoRotateSpeed: -0.5,\n        rotateSpeed: 0.5,\n        zoomSpeed: 0.8,\n        minDistance: 200,\n        maxDistance: 800,\n        minPolarAngle: 0 /*Math.PI / 6,*/,\n        maxPolarAngle: (7 / 16) * Math.PI,\n        minAzimuthAngle: -Infinity,\n        maxAzimuthAngle: Infinity,\n        enableDamping: true,\n        dampingFactor: 0.5,\n        enableZoom: true,\n        target: {\n            x: 0,\n            y: 0,\n            z: 0\n        }\n    },\n    ambientLight: {\n        enabled: true,\n        color: 0x141414\n    },\n    directionalLight: {\n        enabled: true,\n        color: 0xf0f0f0,\n        intensity: 0.4,\n        x: -75,\n        y: 280,\n        z: 150\n    },\n    shadow: {\n        enabled: true,\n        helperEnabled: false,\n        bias: 0,\n        mapWidth: 2048,\n        mapHeight: 2048,\n        near: 250,\n        far: 400,\n        top: 100,\n        right: 100,\n        bottom: -100,\n        left: -100\n    },\n    pointLight: {\n        enabled: true,\n        color: 0xffffff,\n        intensity: 0.34,\n        distance: 115,\n        x: 0,\n        y: 0,\n        z: 0\n    },\n    hemiLight: {\n        enabled: true,\n        color: 0xc8c8c8,\n        groundColor: 0xffffff,\n        intensity: 0.55,\n        x: 0,\n        y: 0,\n        z: 0\n    }\n};\n","/**\n * @author alteredq / http://alteredqualia.com/\n * @author mr.doob / http://mrdoob.com/\n */\n\nexport default {\n    canvas: !!window.CanvasRenderingContext2D,\n    webgl: (function () {\n        try {\n            var canvas = document.createElement('canvas');\n\n            return !!(\n                window.WebGLRenderingContext &&\n                (canvas.getContext('webgl') || canvas.getContext('experimental-webgl'))\n            );\n        } catch (e) {\n            return false;\n        }\n    })(),\n\n    workers: !!window.Worker,\n    fileapi: window.File && window.FileReader && window.FileList && window.Blob,\n\n    getWebGLErrorMessage: function () {\n        var element = document.createElement('div');\n        element.id = 'webgl-error-message';\n        element.style.fontFamily = 'monospace';\n        element.style.fontSize = '13px';\n        element.style.fontWeight = 'normal';\n        element.style.textAlign = 'center';\n        element.style.background = '#fff';\n        element.style.color = '#000';\n        element.style.padding = '1.5em';\n        element.style.width = '400px';\n        element.style.margin = '5em auto 0';\n\n        if (!this.webgl) {\n            element.innerHTML = window.WebGLRenderingContext\n                ? [\n                      'Your graphics card does not seem to support <a href=\"http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation\" style=\"color:#000000\">WebGL</a>.<br />',\n                      'Find out how to get it <a href=\"http://get.webgl.org/\" style=\"color:#000000\">here</a>.'\n                  ].join('\\n')\n                : [\n                      'Your browser does not seem to support <a href=\"http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation\" style=\"color:#000000\">WebGL</a>.<br/>',\n                      'Find out how to get it <a href=\"http://get.webgl.org/\" style=\"color:#000000\">here</a>.'\n                  ].join('\\n');\n        }\n\n        return element;\n    },\n\n    addGetWebGLMessage: function (parameters) {\n        var parent, id, element;\n\n        parameters = parameters || {};\n\n        parent = parameters.parent !== undefined ? parameters.parent : document.body;\n        id = parameters.id !== undefined ? parameters.id : 'oldie';\n\n        element = this.getWebGLErrorMessage();\n        element.id = id;\n\n        parent.appendChild(element);\n    }\n};\n","import * as THREE from 'three';\n\nimport Config from '../../data/config';\n\n// Main webGL renderer class\nexport default class Renderer {\n    constructor(scene, container) {\n        // Properties\n        this.scene = scene;\n        this.container = container;\n\n        // Create WebGL renderer and set its antialias\n        this.threeRenderer = new THREE.WebGLRenderer({ antialias: true });\n\n        // Set clear color to fog to enable fog or to hex color for no fog\n        this.threeRenderer.setClearColor(scene.fog.color);\n        this.threeRenderer.setPixelRatio(window.devicePixelRatio); // For retina\n\n        // Appends canvas\n        container.appendChild(this.threeRenderer.domElement);\n\n        // Shadow map options\n        this.threeRenderer.shadowMap.enabled = true;\n        this.threeRenderer.shadowMap.type = THREE.PCFSoftShadowMap;\n\n        // Get anisotropy for textures\n        Config.maxAnisotropy = this.threeRenderer.capabilities.getMaxAnisotropy();\n\n        // Initial size update set to canvas container\n        this.updateSize();\n\n        // Listeners\n        document.addEventListener('DOMContentLoaded', () => this.updateSize(), false);\n        window.addEventListener('resize', () => this.updateSize(), false);\n    }\n\n    updateSize() {\n        this.threeRenderer.setSize(this.container.offsetWidth, this.container.offsetHeight);\n    }\n\n    render(scene, camera) {\n        // Renders scene to canvas target\n        this.threeRenderer.render(scene, camera);\n    }\n}\n","import { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\nimport { CSS2DRenderer, CSS2DObject } from 'three/examples/jsm/renderers/CSS2DRenderer.js';\nimport Config from '../../data/config';\n\nexport default function () {\n    let renderer = new CSS2DRenderer();\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    renderer.domElement.style.position = 'absolute';\n    renderer.domElement.style.top = '0px';\n    renderer.isShowingLables = Config.isShowingLables;\n    renderer.isShowingObstacleLables = Config.labelsVisibility.obstacles;\n    renderer.isShowingRobotLables = Config.labelsVisibility.robots;\n    return renderer;\n}\n\nexport const addLabel = (prefix, object, mesh, visibility) => {\n    if (mesh !== undefined) {\n        let element = document.createElement('div');\n        element.className = 'label';\n        element.textContent = `${prefix}[${object.id}]`;\n        element.style.marginTop = '-1.2em';\n        const elementLabel = new CSS2DObject(element);\n        elementLabel.name = `Label[${object.id}]`;\n        elementLabel.position.set(0, 1, 0);\n        elementLabel.visible = visibility;\n        mesh.add(elementLabel);\n        mesh.removeLabel = () => {\n            mesh.remove(elementLabel);\n        };\n    }\n};\n\nexport const removeLabel = (mesh) => {\n    if (mesh !== undefined && mesh.removeLabel !== undefined) {\n        mesh.removeLabel();\n    }\n};\n","import * as THREE from 'three';\n\nimport Config from '../../data/config';\n\n// Class that creates and updates the main camera\nexport default class Camera {\n    constructor(renderer) {\n        const width = renderer.domElement.width;\n        const height = renderer.domElement.height;\n\n        // Create and position a Perspective Camera\n        this.threeCamera = new THREE.PerspectiveCamera(\n            Config.camera.fov,\n            width / height,\n            Config.camera.near,\n            Config.camera.far\n        );\n        this.threeCamera.position.set(Config.camera.posX, Config.camera.posY, Config.camera.posZ);\n        this.threeCamera.up.set(0, 0, 1);\n\n        // Initial sizing\n        this.updateSize(renderer);\n\n        // Listeners\n        window.addEventListener('resize', () => this.updateSize(renderer), false);\n    }\n\n    updateSize(renderer) {\n        // Update camera aspect ratio with window aspect ratio\n        this.threeCamera.aspect = renderer.domElement.width / renderer.domElement.height;\n\n        // Always call updateProjectionMatrix on camera change\n        this.threeCamera.updateProjectionMatrix();\n    }\n}\n","import * as THREE from 'three';\n\nimport Config from '../../data/config';\n\n// Sets up and places all lights in scene\nexport default class Light {\n    constructor(scene) {\n        this.scene = scene;\n\n        this.init();\n    }\n\n    init() {\n        // Ambient\n        this.ambientLight = new THREE.AmbientLight(Config.ambientLight.color);\n        this.ambientLight.visible = Config.ambientLight.enabled;\n\n        // Point light\n        this.pointLight = new THREE.PointLight(\n            Config.pointLight.color,\n            Config.pointLight.intensity,\n            Config.pointLight.distance\n        );\n        this.pointLight.position.set(Config.pointLight.x, Config.pointLight.y, Config.pointLight.z);\n        this.pointLight.visible = Config.pointLight.enabled;\n\n        // Directional light\n        this.directionalLight = new THREE.DirectionalLight(\n            Config.directionalLight.color,\n            Config.directionalLight.intensity\n        );\n        this.directionalLight.position.set(\n            Config.directionalLight.x,\n            Config.directionalLight.y,\n            Config.directionalLight.z\n        );\n        this.directionalLight.visible = Config.directionalLight.enabled;\n\n        // Shadow map\n        this.directionalLight.castShadow = Config.shadow.enabled;\n        this.directionalLight.shadow.bias = Config.shadow.bias;\n        this.directionalLight.shadow.camera.near = Config.shadow.near;\n        this.directionalLight.shadow.camera.far = Config.shadow.far;\n        this.directionalLight.shadow.camera.left = Config.shadow.left;\n        this.directionalLight.shadow.camera.right = Config.shadow.right;\n        this.directionalLight.shadow.camera.top = Config.shadow.top;\n        this.directionalLight.shadow.camera.bottom = Config.shadow.bottom;\n        this.directionalLight.shadow.mapSize.width = Config.shadow.mapWidth;\n        this.directionalLight.shadow.mapSize.height = Config.shadow.mapHeight;\n\n        // Shadow camera helper\n        this.directionalLightHelper = new THREE.CameraHelper(this.directionalLight.shadow.camera);\n        this.directionalLightHelper.visible = Config.shadow.helperEnabled;\n\n        // Hemisphere light\n        this.hemiLight = new THREE.HemisphereLight(\n            Config.hemiLight.color,\n            Config.hemiLight.groundColor,\n            Config.hemiLight.intensity\n        );\n        this.hemiLight.position.set(Config.hemiLight.x, Config.hemiLight.y, Config.hemiLight.z);\n        this.hemiLight.visible = Config.hemiLight.enabled;\n    }\n\n    place(lightName) {\n        switch (lightName) {\n            case 'ambient':\n                this.scene.add(this.ambientLight);\n                break;\n\n            case 'directional':\n                this.scene.add(this.directionalLight);\n                this.scene.add(this.directionalLightHelper);\n                break;\n\n            case 'point':\n                this.scene.add(this.pointLight);\n                break;\n\n            case 'hemi':\n                this.scene.add(this.hemiLight);\n                break;\n        }\n    }\n}\n","import * as THREE from 'three';\n\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls';\nimport Config from '../../data/config';\n\n// Controls based on orbit controls\nexport default class Controls {\n    constructor(camera, container) {\n        this.threeControls = new OrbitControls(camera, container);\n\n        this.init();\n    }\n\n    init() {\n        this.threeControls.target.set(Config.controls.target.x, Config.controls.target.y, Config.controls.target.z);\n        this.threeControls.autoRotate = Config.controls.autoRotate;\n        this.threeControls.autoRotateSpeed = Config.controls.autoRotateSpeed;\n        this.threeControls.rotateSpeed = Config.controls.rotateSpeed;\n        this.threeControls.zoomSpeed = Config.controls.zoomSpeed;\n        this.threeControls.minDistance = Config.controls.minDistance;\n        this.threeControls.maxDistance = Config.controls.maxDistance;\n        this.threeControls.minPolarAngle = Config.controls.minPolarAngle;\n        this.threeControls.maxPolarAngle = Config.controls.maxPolarAngle;\n        this.threeControls.enableDamping = Config.controls.enableDamping;\n        this.threeControls.enableZoom = Config.controls.enableZoom;\n        this.threeControls.dampingFactor = Config.controls.dampingFactor;\n\n        this.threeControls.enableRotate = true;\n        this.threeControls.minAzimuthAngle = Config.controls.minAzimuthAngle;\n        this.threeControls.maxAzimuthAngle = Config.controls.maxAzimuthAngle;\n\n        /*this.threeControls.mouseButtons = {\n            LEFT: THREE.MOUSE.ROTATE,\n            MIDDLE: THREE.MOUSE.DOLLY,\n            RIGHT: THREE.MOUSE.PAN\n        }*/\n    }\n}\n","import * as THREE from 'three';\n\nimport Config from '../../data/config';\n\nexport default class Environment {\n    constructor() {\n        console.log(`Environment: Scale: ${scene_scale}`);\n\n        var geometry = new THREE.PlaneBufferGeometry(Config.arena.size, Config.arena.size);\n        var material = new THREE.MeshPhongMaterial({\n            color: 0x999999,\n            depthWrite: false\n        });\n        material.userData.originalColor = new THREE.Color(0x999999);\n\n        // Ground\n        var ground = new THREE.Mesh(geometry, material);\n        ground.scale.set(scene_scale, scene_scale, scene_scale);\n        ground.position.set(0, 0, 0);\n        ground.receiveShadow = true;\n        scene.add(ground);\n\n        // Grid\n        var grid = new THREE.GridHelper(Config.arena.size, 30, 0x000000, 0x5b5b5b);\n        grid.rotation.x = -Math.PI / 2;\n        grid.scale.set(scene_scale, scene_scale, scene_scale);\n        grid.position.set(0, 0, 0);\n        grid.material.opacity = 0.35;\n        grid.material.transparent = true;\n        scene.add(grid);\n    }\n}\n","/**\n * @author mrdoob / http://mrdoob.com/\n * @author WestLangley / http://github.com/WestLangley\n */\n\nimport { BufferGeometry, Float32BufferAttribute, LineSegments, LineBasicMaterial, Matrix3, Vector3 } from 'three';\n\nconst _v1 = new Vector3();\nconst _v2 = new Vector3();\nconst _normalMatrix = new Matrix3();\nconst _keys = ['a', 'b', 'c'];\n\nfunction VertexNormalsHelper(object, size, hex) {\n    this.object = object;\n    this.size = size !== undefined ? size : 0.1;\n\n    const color = hex !== undefined ? hex : 0xff0000;\n\n    //\n\n    let nNormals = 0;\n\n    const objGeometry = this.object.geometry;\n\n    if (objGeometry && objGeometry.isGeometry) {\n        nNormals = objGeometry.faces.length * 3;\n    } else if (objGeometry && objGeometry.isBufferGeometry) {\n        nNormals = objGeometry.attributes.normal.count;\n    }\n\n    //\n\n    const geometry = new BufferGeometry();\n    const positions = new Float32BufferAttribute(nNormals * 2 * 3, 3);\n\n    geometry.setAttribute('position', positions);\n\n    LineSegments.call(this, geometry, new LineBasicMaterial({ color: color, toneMapped: false }));\n\n    this.type = 'VertexNormalsHelper';\n\n    //\n\n    this.matrixAutoUpdate = false;\n\n    this.update();\n}\n\nVertexNormalsHelper.prototype = Object.create(LineSegments.prototype);\nVertexNormalsHelper.prototype.constructor = VertexNormalsHelper;\n\nVertexNormalsHelper.prototype.update = function () {\n    let idx;\n    this.object.updateMatrixWorld(true);\n\n    _normalMatrix.getNormalMatrix(this.object.matrixWorld);\n\n    const matrixWorld = this.object.matrixWorld;\n    const position = this.geometry.attributes.position;\n\n    //\n\n    const objGeometry = this.object.geometry;\n\n    if (objGeometry && objGeometry.isGeometry) {\n        const vertices = objGeometry.vertices;\n\n        const faces = objGeometry.faces;\n\n        idx = 0;\n\n        for (let i = 0, l = faces.length; i < l; i++) {\n            const face = faces[i];\n\n            for (let j = 0, jl = face.vertexNormals.length; j < jl; j++) {\n                const vertex = vertices[face[_keys[j]]];\n                const normal = face.vertexNormals[j];\n\n                _v1.copy(vertex).applyMatrix4(matrixWorld);\n                _v2.copy(normal).applyMatrix3(_normalMatrix).normalize().multiplyScalar(this.size).add(_v1);\n\n                position.setXYZ(idx, _v1.x, _v1.y, _v1.z);\n\n                idx = idx + 1;\n\n                position.setXYZ(idx, _v2.x, _v2.y, _v2.z);\n\n                idx = idx + 1;\n            }\n        }\n    } else if (objGeometry && objGeometry.isBufferGeometry) {\n        const objPos = objGeometry.attributes.position;\n        const objNorm = objGeometry.attributes.normal;\n\n        idx = 0;\n\n        // for simplicity, ignore index and drawcalls, and render every normal\n\n        for (var j = 0, jl = objPos.count; j < jl; j++) {\n            _v1.set(objPos.getX(j), objPos.getY(j), objPos.getZ(j)).applyMatrix4(matrixWorld);\n            _v2.set(objNorm.getX(j), objNorm.getY(j), objNorm.getZ(j));\n            _v2.applyMatrix3(_normalMatrix).normalize().multiplyScalar(this.size).add(_v1);\n\n            position.setXYZ(idx, _v1.x, _v1.y, _v1.z);\n\n            idx = idx + 1;\n\n            position.setXYZ(idx, _v2.x, _v2.y, _v2.z);\n\n            idx = idx + 1;\n        }\n    }\n\n    position.needsUpdate = true;\n};\n\nexport { VertexNormalsHelper };\n","import * as THREE from 'three';\nimport { VertexNormalsHelper } from './vertexNormalsHelper';\n\n// Simple mesh helper that shows edges, wireframes, and face and vertex normals\nexport default class MeshHelper {\n    constructor(scene, mesh) {\n        this.mesh = mesh;\n        this.scene = scene;\n\n        const wireframe = new THREE.WireframeGeometry(this.mesh.geometry);\n        this.wireLine = new THREE.LineSegments(wireframe);\n        this.wireLine.material.depthTest = false;\n        this.wireLine.material.opacity = 0.25;\n        this.wireLine.material.transparent = true;\n\n        const edges = new THREE.EdgesGeometry(this.mesh.geometry);\n        this.edgesLine = new THREE.LineSegments(edges);\n        this.edgesLine.material.depthTest = false;\n        this.edgesLine.material.opacity = 0.25;\n        this.edgesLine.material.transparent = true;\n\n        this.vertexHelper = new VertexNormalsHelper(this.mesh, 2);\n        this.boxHelper = new THREE.BoxHelper(this.mesh);\n    }\n\n    enable() {\n        this.mesh.add(this.wireLine);\n        this.mesh.add(this.edgesLine);\n\n        this.scene.add(this.vertexHelper);\n        this.scene.add(this.boxHelper);\n    }\n\n    disable() {\n        this.mesh.remove(this.wireLine);\n        this.mesh.remove(this.edgesLine);\n\n        this.scene.remove(this.vertexHelper);\n        this.scene.remove(this.boxHelper);\n    }\n}\n","// Provides simple static functions that are used multiple times in the app\nexport default class Helpers {\n    static throttle(fn, threshhold, scope) {\n        threshhold || (threshhold = 250);\n        let last, deferTimer;\n\n        return function () {\n            const context = scope || this;\n\n            const now = +new Date(),\n                args = arguments;\n\n            if (last && now < last + threshhold) {\n                clearTimeout(deferTimer);\n                deferTimer = setTimeout(function () {\n                    last = now;\n                    fn.apply(context, args);\n                }, threshhold);\n            } else {\n                last = now;\n                fn.apply(context, args);\n            }\n        };\n    }\n\n    static logProgress() {\n        return function (xhr) {\n            if (xhr.lengthComputable) {\n                const percentComplete = (xhr.loaded / xhr.total) * 100;\n\n                console.log(Math.round(percentComplete, 2) + '% downloaded');\n            }\n        };\n    }\n\n    static logError() {\n        return function (xhr) {\n            console.error(xhr);\n        };\n    }\n\n    static handleColorChange(color) {\n        return (value) => {\n            if (typeof value === 'string') {\n                value = value.replace('#', '0x');\n            }\n\n            color.setHex(value);\n        };\n    }\n\n    static update(mesh) {\n        this.needsUpdate(mesh.material, mesh.geometry);\n    }\n\n    static needsUpdate(material, geometry) {\n        return function () {\n            material.shading = +material.shading; //Ensure number\n            material.vertexColors = +material.vertexColors; //Ensure number\n            material.side = +material.side; //Ensure number\n            material.needsUpdate = true;\n            geometry.verticesNeedUpdate = true;\n            geometry.normalsNeedUpdate = true;\n            geometry.colorsNeedUpdate = true;\n        };\n    }\n\n    static updateTexture(material, materialKey, textures) {\n        return function (key) {\n            material[materialKey] = textures[key];\n            material.needsUpdate = true;\n        };\n    }\n}\n","import * as THREE from 'three';\n// Promise polyfill for IE\nimport { Promise } from 'es6-promise';\n\nimport Helpers from '../../utils/helpers';\nimport Config from '../../data/config';\n\n// This class preloads all textures in the imageFiles array in the Config via ES6 Promises.\n// Once all textures are done loading the model itself will be loaded after the Promise .then() callback.\n// Using promises to preload textures prevents issues when applying textures to materials\n// before the textures have loaded.\nexport default class Texture {\n    constructor() {\n        // Prop that will contain all loaded textures\n        this.textures = {};\n    }\n\n    load() {\n        const loader = new THREE.TextureLoader();\n        const maxAnisotropy = Config.maxAnisotropy;\n        const imageFiles = Config.texture.imageFiles;\n        const promiseArray = [];\n\n        loader.setPath(Config.texture.path);\n\n        imageFiles.forEach((imageFile) => {\n            // Add an individual Promise for each image in array\n            promiseArray.push(\n                new Promise((resolve, reject) => {\n                    // Each Promise will attempt to load the image file\n                    loader.load(\n                        imageFile.image,\n                        // This gets called on load with the loaded texture\n                        (texture) => {\n                            texture.anisotropy = maxAnisotropy;\n\n                            // Resolve Promise with object of texture if it is instance of THREE.Texture\n                            const modelOBJ = {};\n                            modelOBJ[imageFile.name] = texture;\n                            if (modelOBJ[imageFile.name] instanceof THREE.Texture) resolve(modelOBJ);\n                        },\n                        Helpers.logProgress(),\n                        (xhr) => reject(new Error(xhr + 'An error occurred loading while loading ' + imageFile.image))\n                    );\n                })\n            );\n        });\n\n        // Iterate through all Promises in array and return another Promise when all have resolved or console log reason when any reject\n        return Promise.all(promiseArray).then(\n            (textures) => {\n                // Set the textures prop object to have name be the resolved texture\n                for (let i = 0; i < textures.length; i++) {\n                    this.textures[Object.keys(textures[i])[0]] = textures[i][Object.keys(textures[i])[0]];\n                }\n            },\n            (reason) => console.log(reason)\n        );\n    }\n}\n","/**\n * @author Rich Tibbett / https://github.com/richtr\n * @author mrdoob / http://mrdoob.com/\n * @author Tony Parisi / http://www.tonyparisi.com/\n * @author Takahiro / https://github.com/takahirox\n * @author Don McCurdy / https://www.donmccurdy.com\n */\n\nimport {\n    AnimationClip,\n    Bone,\n    Box3,\n    BufferAttribute,\n    BufferGeometry,\n    ClampToEdgeWrapping,\n    Color,\n    DirectionalLight,\n    DoubleSide,\n    FileLoader,\n    FrontSide,\n    Group,\n    InterleavedBuffer,\n    InterleavedBufferAttribute,\n    Interpolant,\n    InterpolateDiscrete,\n    InterpolateLinear,\n    Line,\n    LineBasicMaterial,\n    LineLoop,\n    LineSegments,\n    LinearFilter,\n    LinearMipmapLinearFilter,\n    LinearMipmapNearestFilter,\n    Loader,\n    LoaderUtils,\n    Material,\n    MathUtils,\n    Matrix4,\n    Mesh,\n    MeshBasicMaterial,\n    MeshPhysicalMaterial,\n    MeshStandardMaterial,\n    MirroredRepeatWrapping,\n    NearestFilter,\n    NearestMipmapLinearFilter,\n    NearestMipmapNearestFilter,\n    NumberKeyframeTrack,\n    Object3D,\n    OrthographicCamera,\n    PerspectiveCamera,\n    PointLight,\n    Points,\n    PointsMaterial,\n    PropertyBinding,\n    QuaternionKeyframeTrack,\n    RGBAFormat,\n    RGBFormat,\n    RepeatWrapping,\n    Skeleton,\n    SkinnedMesh,\n    Sphere,\n    SpotLight,\n    TangentSpaceNormalMap,\n    TextureLoader,\n    TriangleFanDrawMode,\n    TriangleStripDrawMode,\n    Vector2,\n    Vector3,\n    VectorKeyframeTrack,\n    sRGBEncoding\n} from 'three';\n\nconst GLTFLoader = (function () {\n    function GLTFLoader(manager) {\n        Loader.call(this, manager);\n\n        this.dracoLoader = null;\n        this.ddsLoader = null;\n    }\n\n    GLTFLoader.prototype = Object.assign(Object.create(Loader.prototype), {\n        constructor: GLTFLoader,\n\n        load: function (url, onLoad, onProgress, onError) {\n            var scope = this;\n\n            var resourcePath;\n\n            if (this.resourcePath !== '') {\n                resourcePath = this.resourcePath;\n            } else if (this.path !== '') {\n                resourcePath = this.path;\n            } else {\n                resourcePath = LoaderUtils.extractUrlBase(url);\n            }\n\n            // Tells the LoadingManager to track an extra item, which resolves after\n            // the model is fully loaded. This means the count of items loaded will\n            // be incorrect, but ensures manager.onLoad() does not fire early.\n            scope.manager.itemStart(url);\n\n            var _onError = function (e) {\n                if (onError) {\n                    onError(e);\n                } else {\n                    console.error(e);\n                }\n\n                scope.manager.itemError(url);\n                scope.manager.itemEnd(url);\n            };\n\n            var loader = new FileLoader(scope.manager);\n\n            loader.setPath(this.path);\n            loader.setResponseType('arraybuffer');\n\n            if (scope.crossOrigin === 'use-credentials') {\n                loader.setWithCredentials(true);\n            }\n\n            loader.load(\n                url,\n                function (data) {\n                    try {\n                        scope.parse(\n                            data,\n                            resourcePath,\n                            function (gltf) {\n                                onLoad(gltf);\n\n                                scope.manager.itemEnd(url);\n                            },\n                            _onError\n                        );\n                    } catch (e) {\n                        _onError(e);\n                    }\n                },\n                onProgress,\n                _onError\n            );\n        },\n\n        setDRACOLoader: function (dracoLoader) {\n            this.dracoLoader = dracoLoader;\n            return this;\n        },\n\n        setDDSLoader: function (ddsLoader) {\n            this.ddsLoader = ddsLoader;\n            return this;\n        },\n\n        parse: function (data, path, onLoad, onError) {\n            var content;\n            var extensions = {};\n\n            if (typeof data === 'string') {\n                content = data;\n            } else {\n                var magic = LoaderUtils.decodeText(new Uint8Array(data, 0, 4));\n\n                if (magic === BINARY_EXTENSION_HEADER_MAGIC) {\n                    try {\n                        extensions[EXTENSIONS.KHR_BINARY_GLTF] = new GLTFBinaryExtension(data);\n                    } catch (error) {\n                        if (onError) onError(error);\n                        return;\n                    }\n\n                    content = extensions[EXTENSIONS.KHR_BINARY_GLTF].content;\n                } else {\n                    content = LoaderUtils.decodeText(new Uint8Array(data));\n                }\n            }\n\n            var json = JSON.parse(content);\n\n            if (json.asset === undefined || json.asset.version[0] < 2) {\n                if (onError)\n                    onError(new Error('THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.'));\n                return;\n            }\n\n            if (json.extensionsUsed) {\n                for (var i = 0; i < json.extensionsUsed.length; ++i) {\n                    var extensionName = json.extensionsUsed[i];\n                    var extensionsRequired = json.extensionsRequired || [];\n\n                    switch (extensionName) {\n                        case EXTENSIONS.KHR_LIGHTS_PUNCTUAL:\n                            extensions[extensionName] = new GLTFLightsExtension(json);\n                            break;\n\n                        case EXTENSIONS.KHR_MATERIALS_CLEARCOAT:\n                            extensions[extensionName] = new GLTFMaterialsClearcoatExtension();\n                            break;\n\n                        case EXTENSIONS.KHR_MATERIALS_UNLIT:\n                            extensions[extensionName] = new GLTFMaterialsUnlitExtension();\n                            break;\n\n                        case EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:\n                            extensions[extensionName] = new GLTFMaterialsPbrSpecularGlossinessExtension();\n                            break;\n\n                        case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\n                            extensions[extensionName] = new GLTFDracoMeshCompressionExtension(json, this.dracoLoader);\n                            break;\n\n                        case EXTENSIONS.MSFT_TEXTURE_DDS:\n                            extensions[extensionName] = new GLTFTextureDDSExtension(this.ddsLoader);\n                            break;\n\n                        case EXTENSIONS.KHR_TEXTURE_TRANSFORM:\n                            extensions[extensionName] = new GLTFTextureTransformExtension();\n                            break;\n\n                        case EXTENSIONS.KHR_MESH_QUANTIZATION:\n                            extensions[extensionName] = new GLTFMeshQuantizationExtension();\n                            break;\n\n                        default:\n                            if (extensionsRequired.indexOf(extensionName) >= 0) {\n                                console.warn('THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".');\n                            }\n                    }\n                }\n            }\n\n            var parser = new GLTFParser(json, extensions, {\n                path: path || this.resourcePath || '',\n                crossOrigin: this.crossOrigin,\n                manager: this.manager\n            });\n\n            parser.parse(onLoad, onError);\n        }\n    });\n\n    /* GLTFREGISTRY */\n\n    function GLTFRegistry() {\n        var objects = {};\n\n        return {\n            get: function (key) {\n                return objects[key];\n            },\n\n            add: function (key, object) {\n                objects[key] = object;\n            },\n\n            remove: function (key) {\n                delete objects[key];\n            },\n\n            removeAll: function () {\n                objects = {};\n            }\n        };\n    }\n\n    /*********************************/\n    /********** EXTENSIONS ***********/\n    /*********************************/\n\n    var EXTENSIONS = {\n        KHR_BINARY_GLTF: 'KHR_binary_glTF',\n        KHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\n        KHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\n        KHR_MATERIALS_CLEARCOAT: 'KHR_materials_clearcoat',\n        KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS: 'KHR_materials_pbrSpecularGlossiness',\n        KHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\n        KHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\n        KHR_MESH_QUANTIZATION: 'KHR_mesh_quantization',\n        MSFT_TEXTURE_DDS: 'MSFT_texture_dds'\n    };\n\n    /**\n     * DDS Texture Extension\n     *\n     * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/MSFT_texture_dds\n     *\n     */\n    function GLTFTextureDDSExtension(ddsLoader) {\n        if (!ddsLoader) {\n            throw new Error('THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader');\n        }\n\n        this.name = EXTENSIONS.MSFT_TEXTURE_DDS;\n        this.ddsLoader = ddsLoader;\n    }\n\n    /**\n     * Punctual Lights Extension\n     *\n     * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\n     */\n    function GLTFLightsExtension(json) {\n        this.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\n\n        var extension = (json.extensions && json.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL]) || {};\n        this.lightDefs = extension.lights || [];\n    }\n\n    GLTFLightsExtension.prototype.loadLight = function (lightIndex) {\n        var lightDef = this.lightDefs[lightIndex];\n        var lightNode;\n\n        var color = new Color(0xffffff);\n        if (lightDef.color !== undefined) color.fromArray(lightDef.color);\n\n        var range = lightDef.range !== undefined ? lightDef.range : 0;\n\n        switch (lightDef.type) {\n            case 'directional':\n                lightNode = new DirectionalLight(color);\n                lightNode.target.position.set(0, 0, -1);\n                lightNode.add(lightNode.target);\n                break;\n\n            case 'point':\n                lightNode = new PointLight(color);\n                lightNode.distance = range;\n                break;\n\n            case 'spot':\n                lightNode = new SpotLight(color);\n                lightNode.distance = range;\n                // Handle spotlight properties.\n                lightDef.spot = lightDef.spot || {};\n                lightDef.spot.innerConeAngle =\n                    lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\n                lightDef.spot.outerConeAngle =\n                    lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\n                lightNode.angle = lightDef.spot.outerConeAngle;\n                lightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\n                lightNode.target.position.set(0, 0, -1);\n                lightNode.add(lightNode.target);\n                break;\n\n            default:\n                throw new Error('THREE.GLTFLoader: Unexpected light type, \"' + lightDef.type + '\".');\n        }\n\n        // Some lights (e.g. spot) default to a position other than the origin. Reset the position\n        // here, because node-level parsing will only override position if explicitly specified.\n        lightNode.position.set(0, 0, 0);\n\n        lightNode.decay = 2;\n\n        if (lightDef.intensity !== undefined) lightNode.intensity = lightDef.intensity;\n\n        lightNode.name = lightDef.name || 'light_' + lightIndex;\n\n        return Promise.resolve(lightNode);\n    };\n\n    /**\n     * Unlit Materials Extension\n     *\n     * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit\n     */\n    function GLTFMaterialsUnlitExtension() {\n        this.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\n    }\n\n    GLTFMaterialsUnlitExtension.prototype.getMaterialType = function () {\n        return MeshBasicMaterial;\n    };\n\n    GLTFMaterialsUnlitExtension.prototype.extendParams = function (materialParams, materialDef, parser) {\n        var pending = [];\n\n        materialParams.color = new Color(1.0, 1.0, 1.0);\n        materialParams.opacity = 1.0;\n\n        var metallicRoughness = materialDef.pbrMetallicRoughness;\n\n        if (metallicRoughness) {\n            if (Array.isArray(metallicRoughness.baseColorFactor)) {\n                var array = metallicRoughness.baseColorFactor;\n\n                materialParams.color.fromArray(array);\n                materialParams.opacity = array[3];\n            }\n\n            if (metallicRoughness.baseColorTexture !== undefined) {\n                pending.push(parser.assignTexture(materialParams, 'map', metallicRoughness.baseColorTexture));\n            }\n        }\n\n        return Promise.all(pending);\n    };\n\n    /**\n     * Clearcoat Materials Extension\n     *\n     * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_clearcoat\n     */\n    function GLTFMaterialsClearcoatExtension() {\n        this.name = EXTENSIONS.KHR_MATERIALS_CLEARCOAT;\n    }\n\n    GLTFMaterialsClearcoatExtension.prototype.getMaterialType = function () {\n        return MeshPhysicalMaterial;\n    };\n\n    GLTFMaterialsClearcoatExtension.prototype.extendParams = function (materialParams, materialDef, parser) {\n        var pending = [];\n\n        var extension = materialDef.extensions[this.name];\n\n        if (extension.clearcoatFactor !== undefined) {\n            materialParams.clearcoat = extension.clearcoatFactor;\n        }\n\n        if (extension.clearcoatTexture !== undefined) {\n            pending.push(parser.assignTexture(materialParams, 'clearcoatMap', extension.clearcoatTexture));\n        }\n\n        if (extension.clearcoatRoughnessFactor !== undefined) {\n            materialParams.clearcoatRoughness = extension.clearcoatRoughnessFactor;\n        }\n\n        if (extension.clearcoatRoughnessTexture !== undefined) {\n            pending.push(\n                parser.assignTexture(materialParams, 'clearcoatRoughnessMap', extension.clearcoatRoughnessTexture)\n            );\n        }\n\n        if (extension.clearcoatNormalTexture !== undefined) {\n            pending.push(parser.assignTexture(materialParams, 'clearcoatNormalMap', extension.clearcoatNormalTexture));\n\n            if (extension.clearcoatNormalTexture.scale !== undefined) {\n                var scale = extension.clearcoatNormalTexture.scale;\n\n                materialParams.clearcoatNormalScale = new Vector2(scale, scale);\n            }\n        }\n\n        return Promise.all(pending);\n    };\n\n    /* BINARY EXTENSION */\n    var BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\n    var BINARY_EXTENSION_HEADER_LENGTH = 12;\n    var BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4e4f534a, BIN: 0x004e4942 };\n\n    function GLTFBinaryExtension(data) {\n        this.name = EXTENSIONS.KHR_BINARY_GLTF;\n        this.content = null;\n        this.body = null;\n\n        var headerView = new DataView(data, 0, BINARY_EXTENSION_HEADER_LENGTH);\n\n        this.header = {\n            magic: LoaderUtils.decodeText(new Uint8Array(data.slice(0, 4))),\n            version: headerView.getUint32(4, true),\n            length: headerView.getUint32(8, true)\n        };\n\n        if (this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC) {\n            throw new Error('THREE.GLTFLoader: Unsupported glTF-Binary header.');\n        } else if (this.header.version < 2.0) {\n            throw new Error('THREE.GLTFLoader: Legacy binary file detected.');\n        }\n\n        var chunkView = new DataView(data, BINARY_EXTENSION_HEADER_LENGTH);\n        var chunkIndex = 0;\n\n        while (chunkIndex < chunkView.byteLength) {\n            var chunkLength = chunkView.getUint32(chunkIndex, true);\n            chunkIndex += 4;\n\n            var chunkType = chunkView.getUint32(chunkIndex, true);\n            chunkIndex += 4;\n\n            if (chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON) {\n                var contentArray = new Uint8Array(data, BINARY_EXTENSION_HEADER_LENGTH + chunkIndex, chunkLength);\n                this.content = LoaderUtils.decodeText(contentArray);\n            } else if (chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN) {\n                var byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n                this.body = data.slice(byteOffset, byteOffset + chunkLength);\n            }\n\n            // Clients must ignore chunks with unknown types.\n\n            chunkIndex += chunkLength;\n        }\n\n        if (this.content === null) {\n            throw new Error('THREE.GLTFLoader: JSON content not found.');\n        }\n    }\n\n    /**\n     * DRACO Mesh Compression Extension\n     *\n     * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_draco_mesh_compression\n     */\n    function GLTFDracoMeshCompressionExtension(json, dracoLoader) {\n        if (!dracoLoader) {\n            throw new Error('THREE.GLTFLoader: No DRACOLoader instance provided.');\n        }\n\n        this.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\n        this.json = json;\n        this.dracoLoader = dracoLoader;\n        this.dracoLoader.preload();\n    }\n\n    GLTFDracoMeshCompressionExtension.prototype.decodePrimitive = function (primitive, parser) {\n        var json = this.json;\n        var dracoLoader = this.dracoLoader;\n        var bufferViewIndex = primitive.extensions[this.name].bufferView;\n        var gltfAttributeMap = primitive.extensions[this.name].attributes;\n        var threeAttributeMap = {};\n        var attributeNormalizedMap = {};\n        var attributeTypeMap = {};\n\n        for (var attributeName in gltfAttributeMap) {\n            var threeAttributeName = ATTRIBUTES[attributeName] || attributeName.toLowerCase();\n\n            threeAttributeMap[threeAttributeName] = gltfAttributeMap[attributeName];\n        }\n\n        for (attributeName in primitive.attributes) {\n            var threeAttributeName = ATTRIBUTES[attributeName] || attributeName.toLowerCase();\n\n            if (gltfAttributeMap[attributeName] !== undefined) {\n                var accessorDef = json.accessors[primitive.attributes[attributeName]];\n                var componentType = WEBGL_COMPONENT_TYPES[accessorDef.componentType];\n\n                attributeTypeMap[threeAttributeName] = componentType;\n                attributeNormalizedMap[threeAttributeName] = accessorDef.normalized === true;\n            }\n        }\n\n        return parser.getDependency('bufferView', bufferViewIndex).then(function (bufferView) {\n            return new Promise(function (resolve) {\n                dracoLoader.decodeDracoFile(\n                    bufferView,\n                    function (geometry) {\n                        for (var attributeName in geometry.attributes) {\n                            var attribute = geometry.attributes[attributeName];\n                            var normalized = attributeNormalizedMap[attributeName];\n\n                            if (normalized !== undefined) attribute.normalized = normalized;\n                        }\n\n                        resolve(geometry);\n                    },\n                    threeAttributeMap,\n                    attributeTypeMap\n                );\n            });\n        });\n    };\n\n    /**\n     * Texture Transform Extension\n     *\n     * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_transform\n     */\n    function GLTFTextureTransformExtension() {\n        this.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\n    }\n\n    GLTFTextureTransformExtension.prototype.extendTexture = function (texture, transform) {\n        texture = texture.clone();\n\n        if (transform.offset !== undefined) {\n            texture.offset.fromArray(transform.offset);\n        }\n\n        if (transform.rotation !== undefined) {\n            texture.rotation = transform.rotation;\n        }\n\n        if (transform.scale !== undefined) {\n            texture.repeat.fromArray(transform.scale);\n        }\n\n        if (transform.texCoord !== undefined) {\n            console.warn('THREE.GLTFLoader: Custom UV sets in \"' + this.name + '\" extension not yet supported.');\n        }\n\n        texture.needsUpdate = true;\n\n        return texture;\n    };\n\n    /**\n     * Specular-Glossiness Extension\n     *\n     * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_pbrSpecularGlossiness\n     */\n\n    /**\n     * A sub class of StandardMaterial with some of the functionality\n     * changed via the `onBeforeCompile` callback\n     * @pailhead\n     */\n\n    function GLTFMeshStandardSGMaterial(params) {\n        MeshStandardMaterial.call(this);\n\n        this.isGLTFSpecularGlossinessMaterial = true;\n\n        //various chunks that need replacing\n        var specularMapParsFragmentChunk = ['#ifdef USE_SPECULARMAP', '\tuniform sampler2D specularMap;', '#endif'].join(\n            '\\n'\n        );\n\n        var glossinessMapParsFragmentChunk = [\n            '#ifdef USE_GLOSSINESSMAP',\n            '\tuniform sampler2D glossinessMap;',\n            '#endif'\n        ].join('\\n');\n\n        var specularMapFragmentChunk = [\n            'vec3 specularFactor = specular;',\n            '#ifdef USE_SPECULARMAP',\n            '\tvec4 texelSpecular = texture2D( specularMap, vUv );',\n            '\ttexelSpecular = sRGBToLinear( texelSpecular );',\n            '\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture',\n            '\tspecularFactor *= texelSpecular.rgb;',\n            '#endif'\n        ].join('\\n');\n\n        var glossinessMapFragmentChunk = [\n            'float glossinessFactor = glossiness;',\n            '#ifdef USE_GLOSSINESSMAP',\n            '\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );',\n            '\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture',\n            '\tglossinessFactor *= texelGlossiness.a;',\n            '#endif'\n        ].join('\\n');\n\n        var lightPhysicalFragmentChunk = [\n            'PhysicalMaterial material;',\n            'material.diffuseColor = diffuseColor.rgb;',\n            'vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );',\n            'float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );',\n            'material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.',\n            'material.specularRoughness += geometryRoughness;',\n            'material.specularRoughness = min( material.specularRoughness, 1.0 );',\n            'material.specularColor = specularFactor.rgb;'\n        ].join('\\n');\n\n        var uniforms = {\n            specular: { value: new Color().setHex(0xffffff) },\n            glossiness: { value: 1 },\n            specularMap: { value: null },\n            glossinessMap: { value: null }\n        };\n\n        this._extraUniforms = uniforms;\n\n        // please see #14031 or #13198 for an alternate approach\n        this.onBeforeCompile = function (shader) {\n            for (var uniformName in uniforms) {\n                shader.uniforms[uniformName] = uniforms[uniformName];\n            }\n\n            shader.fragmentShader = shader.fragmentShader.replace('uniform float roughness;', 'uniform vec3 specular;');\n            shader.fragmentShader = shader.fragmentShader.replace(\n                'uniform float metalness;',\n                'uniform float glossiness;'\n            );\n            shader.fragmentShader = shader.fragmentShader.replace(\n                '#include <roughnessmap_pars_fragment>',\n                specularMapParsFragmentChunk\n            );\n            shader.fragmentShader = shader.fragmentShader.replace(\n                '#include <metalnessmap_pars_fragment>',\n                glossinessMapParsFragmentChunk\n            );\n            shader.fragmentShader = shader.fragmentShader.replace(\n                '#include <roughnessmap_fragment>',\n                specularMapFragmentChunk\n            );\n            shader.fragmentShader = shader.fragmentShader.replace(\n                '#include <metalnessmap_fragment>',\n                glossinessMapFragmentChunk\n            );\n            shader.fragmentShader = shader.fragmentShader.replace(\n                '#include <lights_physical_fragment>',\n                lightPhysicalFragmentChunk\n            );\n        };\n\n        /*eslint-disable*/\n        Object.defineProperties(this, {\n            specular: {\n                get: function () {\n                    return uniforms.specular.value;\n                },\n                set: function (v) {\n                    uniforms.specular.value = v;\n                }\n            },\n            specularMap: {\n                get: function () {\n                    return uniforms.specularMap.value;\n                },\n                set: function (v) {\n                    uniforms.specularMap.value = v;\n                }\n            },\n            glossiness: {\n                get: function () {\n                    return uniforms.glossiness.value;\n                },\n                set: function (v) {\n                    uniforms.glossiness.value = v;\n                }\n            },\n            glossinessMap: {\n                get: function () {\n                    return uniforms.glossinessMap.value;\n                },\n                set: function (v) {\n                    uniforms.glossinessMap.value = v;\n                    //how about something like this - @pailhead\n                    if (v) {\n                        this.defines.USE_GLOSSINESSMAP = '';\n                        // set USE_ROUGHNESSMAP to enable vUv\n                        this.defines.USE_ROUGHNESSMAP = '';\n                    } else {\n                        delete this.defines.USE_ROUGHNESSMAP;\n                        delete this.defines.USE_GLOSSINESSMAP;\n                    }\n                }\n            }\n        });\n\n        /*eslint-enable*/\n        delete this.metalness;\n        delete this.roughness;\n        delete this.metalnessMap;\n        delete this.roughnessMap;\n\n        this.setValues(params);\n    }\n\n    GLTFMeshStandardSGMaterial.prototype = Object.create(MeshStandardMaterial.prototype);\n    GLTFMeshStandardSGMaterial.prototype.constructor = GLTFMeshStandardSGMaterial;\n\n    GLTFMeshStandardSGMaterial.prototype.copy = function (source) {\n        MeshStandardMaterial.prototype.copy.call(this, source);\n        this.specularMap = source.specularMap;\n        this.specular.copy(source.specular);\n        this.glossinessMap = source.glossinessMap;\n        this.glossiness = source.glossiness;\n        delete this.metalness;\n        delete this.roughness;\n        delete this.metalnessMap;\n        delete this.roughnessMap;\n        return this;\n    };\n\n    function GLTFMaterialsPbrSpecularGlossinessExtension() {\n        return {\n            name: EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,\n\n            specularGlossinessParams: [\n                'color',\n                'map',\n                'lightMap',\n                'lightMapIntensity',\n                'aoMap',\n                'aoMapIntensity',\n                'emissive',\n                'emissiveIntensity',\n                'emissiveMap',\n                'bumpMap',\n                'bumpScale',\n                'normalMap',\n                'normalMapType',\n                'displacementMap',\n                'displacementScale',\n                'displacementBias',\n                'specularMap',\n                'specular',\n                'glossinessMap',\n                'glossiness',\n                'alphaMap',\n                'envMap',\n                'envMapIntensity',\n                'refractionRatio'\n            ],\n\n            getMaterialType: function () {\n                return GLTFMeshStandardSGMaterial;\n            },\n\n            extendParams: function (materialParams, materialDef, parser) {\n                var pbrSpecularGlossiness = materialDef.extensions[this.name];\n\n                materialParams.color = new Color(1.0, 1.0, 1.0);\n                materialParams.opacity = 1.0;\n\n                var pending = [];\n\n                if (Array.isArray(pbrSpecularGlossiness.diffuseFactor)) {\n                    var array = pbrSpecularGlossiness.diffuseFactor;\n\n                    materialParams.color.fromArray(array);\n                    materialParams.opacity = array[3];\n                }\n\n                if (pbrSpecularGlossiness.diffuseTexture !== undefined) {\n                    pending.push(parser.assignTexture(materialParams, 'map', pbrSpecularGlossiness.diffuseTexture));\n                }\n\n                materialParams.emissive = new Color(0.0, 0.0, 0.0);\n                materialParams.glossiness =\n                    pbrSpecularGlossiness.glossinessFactor !== undefined ? pbrSpecularGlossiness.glossinessFactor : 1.0;\n                materialParams.specular = new Color(1.0, 1.0, 1.0);\n\n                if (Array.isArray(pbrSpecularGlossiness.specularFactor)) {\n                    materialParams.specular.fromArray(pbrSpecularGlossiness.specularFactor);\n                }\n\n                if (pbrSpecularGlossiness.specularGlossinessTexture !== undefined) {\n                    var specGlossMapDef = pbrSpecularGlossiness.specularGlossinessTexture;\n                    pending.push(parser.assignTexture(materialParams, 'glossinessMap', specGlossMapDef));\n                    pending.push(parser.assignTexture(materialParams, 'specularMap', specGlossMapDef));\n                }\n\n                return Promise.all(pending);\n            },\n\n            createMaterial: function (materialParams) {\n                var material = new GLTFMeshStandardSGMaterial(materialParams);\n                material.fog = true;\n\n                material.color = materialParams.color;\n\n                material.map = materialParams.map === undefined ? null : materialParams.map;\n\n                material.lightMap = null;\n                material.lightMapIntensity = 1.0;\n\n                material.aoMap = materialParams.aoMap === undefined ? null : materialParams.aoMap;\n                material.aoMapIntensity = 1.0;\n\n                material.emissive = materialParams.emissive;\n                material.emissiveIntensity = 1.0;\n                material.emissiveMap = materialParams.emissiveMap === undefined ? null : materialParams.emissiveMap;\n\n                material.bumpMap = materialParams.bumpMap === undefined ? null : materialParams.bumpMap;\n                material.bumpScale = 1;\n\n                material.normalMap = materialParams.normalMap === undefined ? null : materialParams.normalMap;\n                material.normalMapType = TangentSpaceNormalMap;\n\n                if (materialParams.normalScale) material.normalScale = materialParams.normalScale;\n\n                material.displacementMap = null;\n                material.displacementScale = 1;\n                material.displacementBias = 0;\n\n                material.specularMap = materialParams.specularMap === undefined ? null : materialParams.specularMap;\n                material.specular = materialParams.specular;\n\n                material.glossinessMap =\n                    materialParams.glossinessMap === undefined ? null : materialParams.glossinessMap;\n                material.glossiness = materialParams.glossiness;\n\n                material.alphaMap = null;\n\n                material.envMap = materialParams.envMap === undefined ? null : materialParams.envMap;\n                material.envMapIntensity = 1.0;\n\n                material.refractionRatio = 0.98;\n\n                return material;\n            }\n        };\n    }\n\n    /**\n     * Mesh Quantization Extension\n     *\n     * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization\n     */\n    function GLTFMeshQuantizationExtension() {\n        this.name = EXTENSIONS.KHR_MESH_QUANTIZATION;\n    }\n\n    /*********************************/\n    /********** INTERPOLATION ********/\n    /*********************************/\n\n    // Spline Interpolation\n    // Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\n    function GLTFCubicSplineInterpolant(parameterPositions, sampleValues, sampleSize, resultBuffer) {\n        Interpolant.call(this, parameterPositions, sampleValues, sampleSize, resultBuffer);\n    }\n\n    GLTFCubicSplineInterpolant.prototype = Object.create(Interpolant.prototype);\n    GLTFCubicSplineInterpolant.prototype.constructor = GLTFCubicSplineInterpolant;\n\n    GLTFCubicSplineInterpolant.prototype.copySampleValue_ = function (index) {\n        // Copies a sample value to the result buffer. See description of glTF\n        // CUBICSPLINE values layout in interpolate_() function below.\n\n        var result = this.resultBuffer,\n            values = this.sampleValues,\n            valueSize = this.valueSize,\n            offset = index * valueSize * 3 + valueSize;\n\n        for (var i = 0; i !== valueSize; i++) {\n            result[i] = values[offset + i];\n        }\n\n        return result;\n    };\n\n    GLTFCubicSplineInterpolant.prototype.beforeStart_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\n    GLTFCubicSplineInterpolant.prototype.afterEnd_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\n    GLTFCubicSplineInterpolant.prototype.interpolate_ = function (i1, t0, t, t1) {\n        var result = this.resultBuffer;\n        var values = this.sampleValues;\n        var stride = this.valueSize;\n\n        var stride2 = stride * 2;\n        var stride3 = stride * 3;\n\n        var td = t1 - t0;\n\n        var p = (t - t0) / td;\n        var pp = p * p;\n        var ppp = pp * p;\n\n        var offset1 = i1 * stride3;\n        var offset0 = offset1 - stride3;\n\n        var s2 = -2 * ppp + 3 * pp;\n        var s3 = ppp - pp;\n        var s0 = 1 - s2;\n        var s1 = s3 - pp + p;\n\n        // Layout of keyframe output values for CUBICSPLINE animations:\n        //   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\n        for (var i = 0; i !== stride; i++) {\n            var p0 = values[offset0 + i + stride]; // splineVertex_k\n            var m0 = values[offset0 + i + stride2] * td; // outTangent_k * (t_k+1 - t_k)\n            var p1 = values[offset1 + i + stride]; // splineVertex_k+1\n            var m1 = values[offset1 + i] * td; // inTangent_k+1 * (t_k+1 - t_k)\n\n            result[i] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\n        }\n\n        return result;\n    };\n\n    /*********************************/\n    /********** INTERNALS ************/\n    /*********************************/\n\n    /* CONSTANTS */\n\n    var WEBGL_CONSTANTS = {\n        FLOAT: 5126,\n        //FLOAT_MAT2: 35674,\n        FLOAT_MAT3: 35675,\n        FLOAT_MAT4: 35676,\n        FLOAT_VEC2: 35664,\n        FLOAT_VEC3: 35665,\n        FLOAT_VEC4: 35666,\n        LINEAR: 9729,\n        REPEAT: 10497,\n        SAMPLER_2D: 35678,\n        POINTS: 0,\n        LINES: 1,\n        LINE_LOOP: 2,\n        LINE_STRIP: 3,\n        TRIANGLES: 4,\n        TRIANGLE_STRIP: 5,\n        TRIANGLE_FAN: 6,\n        UNSIGNED_BYTE: 5121,\n        UNSIGNED_SHORT: 5123\n    };\n\n    var WEBGL_COMPONENT_TYPES = {\n        5120: Int8Array,\n        5121: Uint8Array,\n        5122: Int16Array,\n        5123: Uint16Array,\n        5125: Uint32Array,\n        5126: Float32Array\n    };\n\n    var WEBGL_FILTERS = {\n        9728: NearestFilter,\n        9729: LinearFilter,\n        9984: NearestMipmapNearestFilter,\n        9985: LinearMipmapNearestFilter,\n        9986: NearestMipmapLinearFilter,\n        9987: LinearMipmapLinearFilter\n    };\n\n    var WEBGL_WRAPPINGS = {\n        33071: ClampToEdgeWrapping,\n        33648: MirroredRepeatWrapping,\n        10497: RepeatWrapping\n    };\n\n    var WEBGL_TYPE_SIZES = {\n        SCALAR: 1,\n        VEC2: 2,\n        VEC3: 3,\n        VEC4: 4,\n        MAT2: 4,\n        MAT3: 9,\n        MAT4: 16\n    };\n\n    var ATTRIBUTES = {\n        POSITION: 'position',\n        NORMAL: 'normal',\n        TANGENT: 'tangent',\n        TEXCOORD_0: 'uv',\n        TEXCOORD_1: 'uv2',\n        COLOR_0: 'color',\n        WEIGHTS_0: 'skinWeight',\n        JOINTS_0: 'skinIndex'\n    };\n\n    var PATH_PROPERTIES = {\n        scale: 'scale',\n        translation: 'position',\n        rotation: 'quaternion',\n        weights: 'morphTargetInfluences'\n    };\n\n    var INTERPOLATION = {\n        CUBICSPLINE: undefined, // We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\n        // keyframe track will be initialized with a default interpolation type, then modified.\n        LINEAR: InterpolateLinear,\n        STEP: InterpolateDiscrete\n    };\n\n    var ALPHA_MODES = {\n        OPAQUE: 'OPAQUE',\n        MASK: 'MASK',\n        BLEND: 'BLEND'\n    };\n\n    var MIME_TYPE_FORMATS = {\n        'image/png': RGBAFormat,\n        'image/jpeg': RGBFormat\n    };\n\n    /* UTILITY FUNCTIONS */\n\n    function resolveURL(url, path) {\n        // Invalid URL\n        if (typeof url !== 'string' || url === '') return '';\n\n        // Host Relative URL\n        if (/^https?:\\/\\//i.test(path) && /^\\//.test(url)) {\n            // eslint-disable-next-line no-useless-escape\n            path = path.replace(/(^https?:\\/\\/[^\\/]+).*/i, '$1');\n        }\n\n        // Absolute URL http://,https://,//\n        if (/^(https?:)?\\/\\//i.test(url)) return url;\n\n        // Data URI\n        if (/^data:.*,.*$/i.test(url)) return url;\n\n        // Blob URL\n        if (/^blob:.*$/i.test(url)) return url;\n\n        // Relative URL\n        return path + url;\n    }\n\n    /**\n     * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n     */\n    function createDefaultMaterial(cache) {\n        if (cache['DefaultMaterial'] === undefined) {\n            cache['DefaultMaterial'] = new MeshStandardMaterial({\n                color: 0xffffff,\n                emissive: 0x000000,\n                metalness: 1,\n                roughness: 1,\n                transparent: false,\n                depthTest: true,\n                side: FrontSide\n            });\n        }\n\n        return cache['DefaultMaterial'];\n    }\n\n    function addUnknownExtensionsToUserData(knownExtensions, object, objectDef) {\n        // Add unknown glTF extensions to an object's userData.\n\n        for (var name in objectDef.extensions) {\n            if (knownExtensions[name] === undefined) {\n                object.userData.gltfExtensions = object.userData.gltfExtensions || {};\n                object.userData.gltfExtensions[name] = objectDef.extensions[name];\n            }\n        }\n    }\n\n    /**\n     * @param {Object3D|Material|BufferGeometry} object\n     * @param {GLTF.definition} gltfDef\n     */\n    function assignExtrasToUserData(object, gltfDef) {\n        if (gltfDef.extras !== undefined) {\n            if (typeof gltfDef.extras === 'object') {\n                Object.assign(object.userData, gltfDef.extras);\n            } else {\n                console.warn('THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras);\n            }\n        }\n    }\n\n    /**\n     * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n     *\n     * @param {BufferGeometry} geometry\n     * @param {Array<GLTF.Target>} targets\n     * @param {GLTFParser} parser\n     * @return {Promise<BufferGeometry>}\n     */\n    function addMorphTargets(geometry, targets, parser) {\n        var hasMorphPosition = false;\n        var hasMorphNormal = false;\n\n        for (var i = 0, il = targets.length; i < il; i++) {\n            var target = targets[i];\n\n            if (target.POSITION !== undefined) hasMorphPosition = true;\n            if (target.NORMAL !== undefined) hasMorphNormal = true;\n\n            if (hasMorphPosition && hasMorphNormal) break;\n        }\n\n        if (!hasMorphPosition && !hasMorphNormal) return Promise.resolve(geometry);\n\n        var pendingPositionAccessors = [];\n        var pendingNormalAccessors = [];\n\n        for (var i = 0, il = targets.length; i < il; i++) {\n            var target = targets[i];\n\n            if (hasMorphPosition) {\n                var pendingAccessor =\n                    target.POSITION !== undefined\n                        ? parser.getDependency('accessor', target.POSITION)\n                        : geometry.attributes.position;\n\n                pendingPositionAccessors.push(pendingAccessor);\n            }\n\n            if (hasMorphNormal) {\n                var pendingAccessor =\n                    target.NORMAL !== undefined\n                        ? parser.getDependency('accessor', target.NORMAL)\n                        : geometry.attributes.normal;\n\n                pendingNormalAccessors.push(pendingAccessor);\n            }\n        }\n\n        return Promise.all([Promise.all(pendingPositionAccessors), Promise.all(pendingNormalAccessors)]).then(function (\n            accessors\n        ) {\n            var morphPositions = accessors[0];\n            var morphNormals = accessors[1];\n\n            if (hasMorphPosition) geometry.morphAttributes.position = morphPositions;\n            if (hasMorphNormal) geometry.morphAttributes.normal = morphNormals;\n            geometry.morphTargetsRelative = true;\n\n            return geometry;\n        });\n    }\n\n    /**\n     * @param {Mesh} mesh\n     * @param {GLTF.Mesh} meshDef\n     */\n    function updateMorphTargets(mesh, meshDef) {\n        mesh.updateMorphTargets();\n\n        if (meshDef.weights !== undefined) {\n            for (var i = 0, il = meshDef.weights.length; i < il; i++) {\n                mesh.morphTargetInfluences[i] = meshDef.weights[i];\n            }\n        }\n\n        // .extras has user-defined data, so check that .extras.targetNames is an array.\n        if (meshDef.extras && Array.isArray(meshDef.extras.targetNames)) {\n            var targetNames = meshDef.extras.targetNames;\n\n            if (mesh.morphTargetInfluences.length === targetNames.length) {\n                mesh.morphTargetDictionary = {};\n\n                for (var i = 0, il = targetNames.length; i < il; i++) {\n                    mesh.morphTargetDictionary[targetNames[i]] = i;\n                }\n            } else {\n                console.warn('THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.');\n            }\n        }\n    }\n\n    function createPrimitiveKey(primitiveDef) {\n        var dracoExtension = primitiveDef.extensions && primitiveDef.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION];\n        var geometryKey;\n\n        if (dracoExtension) {\n            geometryKey =\n                'draco:' +\n                dracoExtension.bufferView +\n                ':' +\n                dracoExtension.indices +\n                ':' +\n                createAttributesKey(dracoExtension.attributes);\n        } else {\n            geometryKey =\n                primitiveDef.indices + ':' + createAttributesKey(primitiveDef.attributes) + ':' + primitiveDef.mode;\n        }\n\n        return geometryKey;\n    }\n\n    function createAttributesKey(attributes) {\n        var attributesKey = '';\n\n        var keys = Object.keys(attributes).sort();\n\n        for (var i = 0, il = keys.length; i < il; i++) {\n            attributesKey += keys[i] + ':' + attributes[keys[i]] + ';';\n        }\n\n        return attributesKey;\n    }\n\n    /* GLTF PARSER */\n\n    function GLTFParser(json, extensions, options) {\n        this.json = json || {};\n        this.extensions = extensions || {};\n        this.options = options || {};\n\n        // loader object cache\n        this.cache = new GLTFRegistry();\n\n        // BufferGeometry caching\n        this.primitiveCache = {};\n\n        this.textureLoader = new TextureLoader(this.options.manager);\n        this.textureLoader.setCrossOrigin(this.options.crossOrigin);\n\n        this.fileLoader = new FileLoader(this.options.manager);\n        this.fileLoader.setResponseType('arraybuffer');\n\n        if (this.options.crossOrigin === 'use-credentials') {\n            this.fileLoader.setWithCredentials(true);\n        }\n    }\n\n    GLTFParser.prototype.parse = function (onLoad, onError) {\n        var parser = this;\n        var json = this.json;\n        var extensions = this.extensions;\n\n        // Clear the loader cache\n        this.cache.removeAll();\n\n        // Mark the special nodes/meshes in json for efficient parse\n        this.markDefs();\n\n        Promise.all([this.getDependencies('scene'), this.getDependencies('animation'), this.getDependencies('camera')])\n            .then(function (dependencies) {\n                var result = {\n                    scene: dependencies[0][json.scene || 0],\n                    scenes: dependencies[0],\n                    animations: dependencies[1],\n                    cameras: dependencies[2],\n                    asset: json.asset,\n                    parser: parser,\n                    userData: {}\n                };\n\n                addUnknownExtensionsToUserData(extensions, result, json);\n\n                assignExtrasToUserData(result, json);\n\n                onLoad(result);\n            })\n            .catch(onError);\n    };\n\n    /**\n     * Marks the special nodes/meshes in json for efficient parse.\n     */\n    GLTFParser.prototype.markDefs = function () {\n        var nodeDefs = this.json.nodes || [];\n        var skinDefs = this.json.skins || [];\n        var meshDefs = this.json.meshes || [];\n\n        var meshReferences = {};\n        var meshUses = {};\n\n        // Nothing in the node definition indicates whether it is a Bone or an\n        // Object3D. Use the skins' joint references to mark bones.\n        for (var skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex++) {\n            var joints = skinDefs[skinIndex].joints;\n\n            for (var i = 0, il = joints.length; i < il; i++) {\n                nodeDefs[joints[i]].isBone = true;\n            }\n        }\n\n        // Meshes can (and should) be reused by multiple nodes in a glTF asset. To\n        // avoid having more than one Mesh with the same name, count\n        // references and rename instances below.\n        //\n        // Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n        for (var nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex++) {\n            var nodeDef = nodeDefs[nodeIndex];\n\n            if (nodeDef.mesh !== undefined) {\n                if (meshReferences[nodeDef.mesh] === undefined) {\n                    meshReferences[nodeDef.mesh] = meshUses[nodeDef.mesh] = 0;\n                }\n\n                meshReferences[nodeDef.mesh]++;\n\n                // Nothing in the mesh definition indicates whether it is\n                // a SkinnedMesh or Mesh. Use the node's mesh reference\n                // to mark SkinnedMesh if node has skin.\n                if (nodeDef.skin !== undefined) {\n                    meshDefs[nodeDef.mesh].isSkinnedMesh = true;\n                }\n            }\n        }\n\n        this.json.meshReferences = meshReferences;\n        this.json.meshUses = meshUses;\n    };\n\n    /**\n     * Requests the specified dependency asynchronously, with caching.\n     * @param {string} type\n     * @param {number} index\n     * @return {Promise<Object3D|Material|THREE.Texture|AnimationClip|ArrayBuffer|Object>}\n     */\n    GLTFParser.prototype.getDependency = function (type, index) {\n        var cacheKey = type + ':' + index;\n        var dependency = this.cache.get(cacheKey);\n\n        if (!dependency) {\n            switch (type) {\n                case 'scene':\n                    dependency = this.loadScene(index);\n                    break;\n\n                case 'node':\n                    dependency = this.loadNode(index);\n                    break;\n\n                case 'mesh':\n                    dependency = this.loadMesh(index);\n                    break;\n\n                case 'accessor':\n                    dependency = this.loadAccessor(index);\n                    break;\n\n                case 'bufferView':\n                    dependency = this.loadBufferView(index);\n                    break;\n\n                case 'buffer':\n                    dependency = this.loadBuffer(index);\n                    break;\n\n                case 'material':\n                    dependency = this.loadMaterial(index);\n                    break;\n\n                case 'texture':\n                    dependency = this.loadTexture(index);\n                    break;\n\n                case 'skin':\n                    dependency = this.loadSkin(index);\n                    break;\n\n                case 'animation':\n                    dependency = this.loadAnimation(index);\n                    break;\n\n                case 'camera':\n                    dependency = this.loadCamera(index);\n                    break;\n\n                case 'light':\n                    dependency = this.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL].loadLight(index);\n                    break;\n\n                default:\n                    throw new Error('Unknown type: ' + type);\n            }\n\n            this.cache.add(cacheKey, dependency);\n        }\n\n        return dependency;\n    };\n\n    /**\n     * Requests all dependencies of the specified type asynchronously, with caching.\n     * @param {string} type\n     * @return {Promise<Array<Object>>}\n     */\n    GLTFParser.prototype.getDependencies = function (type) {\n        var dependencies = this.cache.get(type);\n\n        if (!dependencies) {\n            var parser = this;\n            var defs = this.json[type + (type === 'mesh' ? 'es' : 's')] || [];\n\n            dependencies = Promise.all(\n                defs.map(function (def, index) {\n                    return parser.getDependency(type, index);\n                })\n            );\n\n            this.cache.add(type, dependencies);\n        }\n\n        return dependencies;\n    };\n\n    /**\n     * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n     * @param {number} bufferIndex\n     * @return {Promise<ArrayBuffer>}\n     */\n    GLTFParser.prototype.loadBuffer = function (bufferIndex) {\n        var bufferDef = this.json.buffers[bufferIndex];\n        var loader = this.fileLoader;\n\n        if (bufferDef.type && bufferDef.type !== 'arraybuffer') {\n            throw new Error('THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.');\n        }\n\n        // If present, GLB container is required to be the first buffer.\n        if (bufferDef.uri === undefined && bufferIndex === 0) {\n            return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);\n        }\n\n        var options = this.options;\n\n        return new Promise(function (resolve, reject) {\n            loader.load(resolveURL(bufferDef.uri, options.path), resolve, undefined, function () {\n                reject(new Error('THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".'));\n            });\n        });\n    };\n\n    /**\n     * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n     * @param {number} bufferViewIndex\n     * @return {Promise<ArrayBuffer>}\n     */\n    GLTFParser.prototype.loadBufferView = function (bufferViewIndex) {\n        var bufferViewDef = this.json.bufferViews[bufferViewIndex];\n\n        return this.getDependency('buffer', bufferViewDef.buffer).then(function (buffer) {\n            var byteLength = bufferViewDef.byteLength || 0;\n            var byteOffset = bufferViewDef.byteOffset || 0;\n            return buffer.slice(byteOffset, byteOffset + byteLength);\n        });\n    };\n\n    /**\n     * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n     * @param {number} accessorIndex\n     * @return {Promise<BufferAttribute|InterleavedBufferAttribute>}\n     */\n    GLTFParser.prototype.loadAccessor = function (accessorIndex) {\n        var parser = this;\n        var json = this.json;\n\n        var accessorDef = this.json.accessors[accessorIndex];\n\n        if (accessorDef.bufferView === undefined && accessorDef.sparse === undefined) {\n            // Ignore empty accessors, which may be used to declare runtime\n            // information about attributes coming from another source (e.g. Draco\n            // compression extension).\n            return Promise.resolve(null);\n        }\n\n        var pendingBufferViews = [];\n\n        if (accessorDef.bufferView !== undefined) {\n            pendingBufferViews.push(this.getDependency('bufferView', accessorDef.bufferView));\n        } else {\n            pendingBufferViews.push(null);\n        }\n\n        if (accessorDef.sparse !== undefined) {\n            pendingBufferViews.push(this.getDependency('bufferView', accessorDef.sparse.indices.bufferView));\n            pendingBufferViews.push(this.getDependency('bufferView', accessorDef.sparse.values.bufferView));\n        }\n\n        return Promise.all(pendingBufferViews).then(function (bufferViews) {\n            var bufferView = bufferViews[0];\n\n            var itemSize = WEBGL_TYPE_SIZES[accessorDef.type];\n            var TypedArray = WEBGL_COMPONENT_TYPES[accessorDef.componentType];\n\n            // For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n            var elementBytes = TypedArray.BYTES_PER_ELEMENT;\n            var itemBytes = elementBytes * itemSize;\n            var byteOffset = accessorDef.byteOffset || 0;\n            var byteStride =\n                accessorDef.bufferView !== undefined ? json.bufferViews[accessorDef.bufferView].byteStride : undefined;\n            var normalized = accessorDef.normalized === true;\n            var array, bufferAttribute;\n\n            // The buffer is not interleaved if the stride is the item size in bytes.\n            if (byteStride && byteStride !== itemBytes) {\n                // Each \"slice\" of the buffer, as defined by 'count' elements of 'byteStride' bytes, gets its own InterleavedBuffer\n                // This makes sure that IBA.count reflects accessor.count properly\n                var ibSlice = Math.floor(byteOffset / byteStride);\n                var ibCacheKey =\n                    'InterleavedBuffer:' +\n                    accessorDef.bufferView +\n                    ':' +\n                    accessorDef.componentType +\n                    ':' +\n                    ibSlice +\n                    ':' +\n                    accessorDef.count;\n                var ib = parser.cache.get(ibCacheKey);\n\n                if (!ib) {\n                    array = new TypedArray(\n                        bufferView,\n                        ibSlice * byteStride,\n                        (accessorDef.count * byteStride) / elementBytes\n                    );\n\n                    // Integer parameters to IB/IBA are in array elements, not bytes.\n                    ib = new InterleavedBuffer(array, byteStride / elementBytes);\n\n                    parser.cache.add(ibCacheKey, ib);\n                }\n\n                bufferAttribute = new InterleavedBufferAttribute(\n                    ib,\n                    itemSize,\n                    (byteOffset % byteStride) / elementBytes,\n                    normalized\n                );\n            } else {\n                if (bufferView === null) {\n                    array = new TypedArray(accessorDef.count * itemSize);\n                } else {\n                    array = new TypedArray(bufferView, byteOffset, accessorDef.count * itemSize);\n                }\n\n                bufferAttribute = new BufferAttribute(array, itemSize, normalized);\n            }\n\n            // https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\n            if (accessorDef.sparse !== undefined) {\n                var itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\n                var TypedArrayIndices = WEBGL_COMPONENT_TYPES[accessorDef.sparse.indices.componentType];\n\n                var byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\n                var byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\n\n                var sparseIndices = new TypedArrayIndices(\n                    bufferViews[1],\n                    byteOffsetIndices,\n                    accessorDef.sparse.count * itemSizeIndices\n                );\n                var sparseValues = new TypedArray(\n                    bufferViews[2],\n                    byteOffsetValues,\n                    accessorDef.sparse.count * itemSize\n                );\n\n                if (bufferView !== null) {\n                    // Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\n                    bufferAttribute = new BufferAttribute(\n                        bufferAttribute.array.slice(),\n                        bufferAttribute.itemSize,\n                        bufferAttribute.normalized\n                    );\n                }\n\n                for (var i = 0, il = sparseIndices.length; i < il; i++) {\n                    var index = sparseIndices[i];\n\n                    bufferAttribute.setX(index, sparseValues[i * itemSize]);\n                    if (itemSize >= 2) bufferAttribute.setY(index, sparseValues[i * itemSize + 1]);\n                    if (itemSize >= 3) bufferAttribute.setZ(index, sparseValues[i * itemSize + 2]);\n                    if (itemSize >= 4) bufferAttribute.setW(index, sparseValues[i * itemSize + 3]);\n                    if (itemSize >= 5)\n                        throw new Error('THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.');\n                }\n            }\n\n            return bufferAttribute;\n        });\n    };\n\n    /**\n     * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n     * @param {number} textureIndex\n     * @return {Promise<THREE.Texture>}\n     */\n    GLTFParser.prototype.loadTexture = function (textureIndex) {\n        var parser = this;\n        var json = this.json;\n        var options = this.options;\n        var textureLoader = this.textureLoader;\n\n        var URL = self.URL || self.webkitURL;\n\n        var textureDef = json.textures[textureIndex];\n\n        var textureExtensions = textureDef.extensions || {};\n\n        var source;\n\n        if (textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS]) {\n            source = json.images[textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS].source];\n        } else {\n            source = json.images[textureDef.source];\n        }\n\n        var sourceURI = source.uri;\n        var isObjectURL = false;\n\n        if (source.bufferView !== undefined) {\n            // Load binary image data from bufferView, if provided.\n\n            sourceURI = parser.getDependency('bufferView', source.bufferView).then(function (bufferView) {\n                isObjectURL = true;\n                var blob = new Blob([bufferView], { type: source.mimeType });\n                sourceURI = URL.createObjectURL(blob);\n                return sourceURI;\n            });\n        }\n\n        return Promise.resolve(sourceURI)\n            .then(function (sourceURI) {\n                // Load Texture resource.\n\n                var loader = options.manager.getHandler(sourceURI);\n\n                if (!loader) {\n                    loader = textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS]\n                        ? parser.extensions[EXTENSIONS.MSFT_TEXTURE_DDS].ddsLoader\n                        : textureLoader;\n                }\n\n                return new Promise(function (resolve, reject) {\n                    loader.load(resolveURL(sourceURI, options.path), resolve, undefined, reject);\n                });\n            })\n            .then(function (texture) {\n                // Clean up resources and configure Texture.\n\n                if (isObjectURL === true) {\n                    URL.revokeObjectURL(sourceURI);\n                }\n\n                texture.flipY = false;\n\n                if (textureDef.name) texture.name = textureDef.name;\n\n                // Ignore unknown mime types, like DDS files.\n                if (source.mimeType in MIME_TYPE_FORMATS) {\n                    texture.format = MIME_TYPE_FORMATS[source.mimeType];\n                }\n\n                var samplers = json.samplers || {};\n                var sampler = samplers[textureDef.sampler] || {};\n\n                texture.magFilter = WEBGL_FILTERS[sampler.magFilter] || LinearFilter;\n                texture.minFilter = WEBGL_FILTERS[sampler.minFilter] || LinearMipmapLinearFilter;\n                texture.wrapS = WEBGL_WRAPPINGS[sampler.wrapS] || RepeatWrapping;\n                texture.wrapT = WEBGL_WRAPPINGS[sampler.wrapT] || RepeatWrapping;\n\n                return texture;\n            });\n    };\n\n    /**\n     * Asynchronously assigns a texture to the given material parameters.\n     * @param {Object} materialParams\n     * @param {string} mapName\n     * @param {Object} mapDef\n     * @return {Promise}\n     */\n    GLTFParser.prototype.assignTexture = function (materialParams, mapName, mapDef) {\n        var parser = this;\n\n        return this.getDependency('texture', mapDef.index).then(function (texture) {\n            if (!texture.isCompressedTexture) {\n                switch (mapName) {\n                    case 'aoMap':\n                    case 'emissiveMap':\n                    case 'metalnessMap':\n                    case 'normalMap':\n                    case 'roughnessMap':\n                        texture.format = RGBFormat;\n                        break;\n                }\n            }\n\n            // Materials sample aoMap from UV set 1 and other maps from UV set 0 - this can't be configured\n            // However, we will copy UV set 0 to UV set 1 on demand for aoMap\n            if (\n                mapDef.texCoord !== undefined &&\n                mapDef.texCoord != 0 &&\n                !(mapName === 'aoMap' && mapDef.texCoord == 1)\n            ) {\n                console.warn(\n                    'THREE.GLTFLoader: Custom UV set ' +\n                        mapDef.texCoord +\n                        ' for texture ' +\n                        mapName +\n                        ' not yet supported.'\n                );\n            }\n\n            if (parser.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]) {\n                var transform =\n                    mapDef.extensions !== undefined ? mapDef.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM] : undefined;\n\n                if (transform) {\n                    texture = parser.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM].extendTexture(texture, transform);\n                }\n            }\n\n            materialParams[mapName] = texture;\n        });\n    };\n\n    /**\n     * Assigns final material to a Mesh, Line, or Points instance. The instance\n     * already has a material (generated from the glTF material options alone)\n     * but reuse of the same glTF material may require multiple threejs materials\n     * to accomodate different primitive types, defines, etc. New materials will\n     * be created if necessary, and reused from a cache.\n     * @param  {Object3D} mesh Mesh, Line, or Points instance.\n     */\n    GLTFParser.prototype.assignFinalMaterial = function (mesh) {\n        var geometry = mesh.geometry;\n        var material = mesh.material;\n\n        var useVertexTangents = geometry.attributes.tangent !== undefined;\n        var useVertexColors = geometry.attributes.color !== undefined;\n        var useFlatShading = geometry.attributes.normal === undefined;\n        var useSkinning = mesh.isSkinnedMesh === true;\n        var useMorphTargets = Object.keys(geometry.morphAttributes).length > 0;\n        var useMorphNormals = useMorphTargets && geometry.morphAttributes.normal !== undefined;\n\n        if (mesh.isPoints) {\n            var cacheKey = 'PointsMaterial:' + material.uuid;\n\n            var pointsMaterial = this.cache.get(cacheKey);\n\n            if (!pointsMaterial) {\n                pointsMaterial = new PointsMaterial();\n                Material.prototype.copy.call(pointsMaterial, material);\n                pointsMaterial.color.copy(material.color);\n                pointsMaterial.map = material.map;\n                pointsMaterial.sizeAttenuation = false; // glTF spec says points should be 1px\n\n                this.cache.add(cacheKey, pointsMaterial);\n            }\n\n            material = pointsMaterial;\n        } else if (mesh.isLine) {\n            var cacheKey = 'LineBasicMaterial:' + material.uuid;\n\n            var lineMaterial = this.cache.get(cacheKey);\n\n            if (!lineMaterial) {\n                lineMaterial = new LineBasicMaterial();\n                Material.prototype.copy.call(lineMaterial, material);\n                lineMaterial.color.copy(material.color);\n\n                this.cache.add(cacheKey, lineMaterial);\n            }\n\n            material = lineMaterial;\n        }\n\n        // Clone the material if it will be modified\n        if (useVertexTangents || useVertexColors || useFlatShading || useSkinning || useMorphTargets) {\n            var cacheKey = 'ClonedMaterial:' + material.uuid + ':';\n\n            if (material.isGLTFSpecularGlossinessMaterial) cacheKey += 'specular-glossiness:';\n            if (useSkinning) cacheKey += 'skinning:';\n            if (useVertexTangents) cacheKey += 'vertex-tangents:';\n            if (useVertexColors) cacheKey += 'vertex-colors:';\n            if (useFlatShading) cacheKey += 'flat-shading:';\n            if (useMorphTargets) cacheKey += 'morph-targets:';\n            if (useMorphNormals) cacheKey += 'morph-normals:';\n\n            var cachedMaterial = this.cache.get(cacheKey);\n\n            if (!cachedMaterial) {\n                cachedMaterial = material.clone();\n\n                if (useSkinning) cachedMaterial.skinning = true;\n                if (useVertexTangents) cachedMaterial.vertexTangents = true;\n                if (useVertexColors) cachedMaterial.vertexColors = true;\n                if (useFlatShading) cachedMaterial.flatShading = true;\n                if (useMorphTargets) cachedMaterial.morphTargets = true;\n                if (useMorphNormals) cachedMaterial.morphNormals = true;\n\n                this.cache.add(cacheKey, cachedMaterial);\n            }\n\n            material = cachedMaterial;\n        }\n\n        // workarounds for mesh and geometry\n\n        if (material.aoMap && geometry.attributes.uv2 === undefined && geometry.attributes.uv !== undefined) {\n            geometry.setAttribute('uv2', geometry.attributes.uv);\n        }\n\n        // https://github.com/mrdoob/three.js/issues/11438#issuecomment-507003995\n        if (material.normalScale && !useVertexTangents) {\n            material.normalScale.y = -material.normalScale.y;\n        }\n\n        if (material.clearcoatNormalScale && !useVertexTangents) {\n            material.clearcoatNormalScale.y = -material.clearcoatNormalScale.y;\n        }\n\n        mesh.material = material;\n    };\n\n    /**\n     * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n     * @param {number} materialIndex\n     * @return {Promise<Material>}\n     */\n    GLTFParser.prototype.loadMaterial = function (materialIndex) {\n        var parser = this;\n        var json = this.json;\n        var extensions = this.extensions;\n        var materialDef = json.materials[materialIndex];\n\n        var materialType;\n        var materialParams = {};\n        var materialExtensions = materialDef.extensions || {};\n\n        var pending = [];\n\n        if (materialExtensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]) {\n            var sgExtension = extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];\n            materialType = sgExtension.getMaterialType();\n            pending.push(sgExtension.extendParams(materialParams, materialDef, parser));\n        } else if (materialExtensions[EXTENSIONS.KHR_MATERIALS_UNLIT]) {\n            var kmuExtension = extensions[EXTENSIONS.KHR_MATERIALS_UNLIT];\n            materialType = kmuExtension.getMaterialType();\n            pending.push(kmuExtension.extendParams(materialParams, materialDef, parser));\n        } else {\n            // Specification:\n            // https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n            materialType = MeshStandardMaterial;\n\n            var metallicRoughness = materialDef.pbrMetallicRoughness || {};\n\n            materialParams.color = new Color(1.0, 1.0, 1.0);\n            materialParams.opacity = 1.0;\n\n            if (Array.isArray(metallicRoughness.baseColorFactor)) {\n                var array = metallicRoughness.baseColorFactor;\n\n                materialParams.color.fromArray(array);\n                materialParams.opacity = array[3];\n            }\n\n            if (metallicRoughness.baseColorTexture !== undefined) {\n                pending.push(parser.assignTexture(materialParams, 'map', metallicRoughness.baseColorTexture));\n            }\n\n            materialParams.metalness =\n                metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n            materialParams.roughness =\n                metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n            if (metallicRoughness.metallicRoughnessTexture !== undefined) {\n                pending.push(\n                    parser.assignTexture(materialParams, 'metalnessMap', metallicRoughness.metallicRoughnessTexture)\n                );\n                pending.push(\n                    parser.assignTexture(materialParams, 'roughnessMap', metallicRoughness.metallicRoughnessTexture)\n                );\n            }\n        }\n\n        if (materialDef.doubleSided === true) {\n            materialParams.side = DoubleSide;\n        }\n\n        var alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\n\n        if (alphaMode === ALPHA_MODES.BLEND) {\n            materialParams.transparent = true;\n\n            // See: https://github.com/mrdoob/three.js/issues/17706\n            materialParams.depthWrite = false;\n        } else {\n            materialParams.transparent = false;\n\n            if (alphaMode === ALPHA_MODES.MASK) {\n                materialParams.alphaTest = materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\n            }\n        }\n\n        if (materialDef.normalTexture !== undefined && materialType !== MeshBasicMaterial) {\n            pending.push(parser.assignTexture(materialParams, 'normalMap', materialDef.normalTexture));\n\n            materialParams.normalScale = new Vector2(1, 1);\n\n            if (materialDef.normalTexture.scale !== undefined) {\n                materialParams.normalScale.set(materialDef.normalTexture.scale, materialDef.normalTexture.scale);\n            }\n        }\n\n        if (materialDef.occlusionTexture !== undefined && materialType !== MeshBasicMaterial) {\n            pending.push(parser.assignTexture(materialParams, 'aoMap', materialDef.occlusionTexture));\n\n            if (materialDef.occlusionTexture.strength !== undefined) {\n                materialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\n            }\n        }\n\n        if (materialDef.emissiveFactor !== undefined && materialType !== MeshBasicMaterial) {\n            materialParams.emissive = new Color().fromArray(materialDef.emissiveFactor);\n        }\n\n        if (materialDef.emissiveTexture !== undefined && materialType !== MeshBasicMaterial) {\n            pending.push(parser.assignTexture(materialParams, 'emissiveMap', materialDef.emissiveTexture));\n        }\n\n        if (materialExtensions[EXTENSIONS.KHR_MATERIALS_CLEARCOAT]) {\n            var clearcoatExtension = extensions[EXTENSIONS.KHR_MATERIALS_CLEARCOAT];\n            materialType = clearcoatExtension.getMaterialType();\n            pending.push(clearcoatExtension.extendParams(materialParams, { extensions: materialExtensions }, parser));\n        }\n\n        return Promise.all(pending).then(function () {\n            var material;\n\n            if (materialType === GLTFMeshStandardSGMaterial) {\n                material = extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(materialParams);\n            } else {\n                material = new materialType(materialParams);\n            }\n\n            if (materialDef.name) material.name = materialDef.name;\n\n            // baseColorTexture, emissiveTexture, and specularGlossinessTexture use sRGB encoding.\n            if (material.map) material.map.encoding = sRGBEncoding;\n            if (material.emissiveMap) material.emissiveMap.encoding = sRGBEncoding;\n\n            assignExtrasToUserData(material, materialDef);\n\n            if (materialDef.extensions) addUnknownExtensionsToUserData(extensions, material, materialDef);\n\n            return material;\n        });\n    };\n\n    /**\n     * @param {BufferGeometry} geometry\n     * @param {GLTF.Primitive} primitiveDef\n     * @param {GLTFParser} parser\n     */\n    function computeBounds(geometry, primitiveDef, parser) {\n        var attributes = primitiveDef.attributes;\n\n        var box = new Box3();\n\n        if (attributes.POSITION !== undefined) {\n            var accessor = parser.json.accessors[attributes.POSITION];\n\n            var min = accessor.min;\n            var max = accessor.max;\n\n            // glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n            if (min !== undefined && max !== undefined) {\n                box.set(new Vector3(min[0], min[1], min[2]), new Vector3(max[0], max[1], max[2]));\n            } else {\n                console.warn('THREE.GLTFLoader: Missing min/max properties for accessor POSITION.');\n\n                return;\n            }\n        } else {\n            return;\n        }\n\n        var targets = primitiveDef.targets;\n\n        if (targets !== undefined) {\n            var maxDisplacement = new Vector3();\n            var vector = new Vector3();\n\n            for (var i = 0, il = targets.length; i < il; i++) {\n                var target = targets[i];\n\n                if (target.POSITION !== undefined) {\n                    var accessor = parser.json.accessors[target.POSITION];\n                    var min = accessor.min;\n                    var max = accessor.max;\n\n                    // glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n                    if (min !== undefined && max !== undefined) {\n                        // we need to get max of absolute components because target weight is [-1,1]\n                        vector.setX(Math.max(Math.abs(min[0]), Math.abs(max[0])));\n                        vector.setY(Math.max(Math.abs(min[1]), Math.abs(max[1])));\n                        vector.setZ(Math.max(Math.abs(min[2]), Math.abs(max[2])));\n\n                        // Note: this assumes that the sum of all weights is at most 1. This isn't quite correct - it's more conservative\n                        // to assume that each target can have a max weight of 1. However, for some use cases - notably, when morph targets\n                        // are used to implement key-frame animations and as such only two are active at a time - this results in very large\n                        // boxes. So for now we make a box that's sometimes a touch too small but is hopefully mostly of reasonable size.\n                        maxDisplacement.max(vector);\n                    } else {\n                        console.warn('THREE.GLTFLoader: Missing min/max properties for accessor POSITION.');\n                    }\n                }\n            }\n\n            // As per comment above this box isn't conservative, but has a reasonable size for a very large number of morph targets.\n            box.expandByVector(maxDisplacement);\n        }\n\n        geometry.boundingBox = box;\n\n        var sphere = new Sphere();\n\n        box.getCenter(sphere.center);\n        sphere.radius = box.min.distanceTo(box.max) / 2;\n\n        geometry.boundingSphere = sphere;\n    }\n\n    /**\n     * @param {BufferGeometry} geometry\n     * @param {GLTF.Primitive} primitiveDef\n     * @param {GLTFParser} parser\n     * @return {Promise<BufferGeometry>}\n     */\n    function addPrimitiveAttributes(geometry, primitiveDef, parser) {\n        var attributes = primitiveDef.attributes;\n\n        var pending = [];\n\n        function assignAttributeAccessor(accessorIndex, attributeName) {\n            return parser.getDependency('accessor', accessorIndex).then(function (accessor) {\n                geometry.setAttribute(attributeName, accessor);\n            });\n        }\n\n        for (var gltfAttributeName in attributes) {\n            var threeAttributeName = ATTRIBUTES[gltfAttributeName] || gltfAttributeName.toLowerCase();\n\n            // Skip attributes already provided by e.g. Draco extension.\n            if (threeAttributeName in geometry.attributes) continue;\n\n            pending.push(assignAttributeAccessor(attributes[gltfAttributeName], threeAttributeName));\n        }\n\n        if (primitiveDef.indices !== undefined && !geometry.index) {\n            var accessor = parser.getDependency('accessor', primitiveDef.indices).then(function (accessor) {\n                geometry.setIndex(accessor);\n            });\n\n            pending.push(accessor);\n        }\n\n        assignExtrasToUserData(geometry, primitiveDef);\n\n        computeBounds(geometry, primitiveDef, parser);\n\n        return Promise.all(pending).then(function () {\n            return primitiveDef.targets !== undefined\n                ? addMorphTargets(geometry, primitiveDef.targets, parser)\n                : geometry;\n        });\n    }\n\n    /**\n     * @param {BufferGeometry} geometry\n     * @param {Number} drawMode\n     * @return {BufferGeometry}\n     */\n    function toTrianglesDrawMode(geometry, drawMode) {\n        var index = geometry.getIndex();\n\n        // generate index if not present\n\n        if (index === null) {\n            var indices = [];\n\n            var position = geometry.getAttribute('position');\n\n            if (position !== undefined) {\n                for (var i = 0; i < position.count; i++) {\n                    indices.push(i);\n                }\n\n                geometry.setIndex(indices);\n                index = geometry.getIndex();\n            } else {\n                console.error(\n                    'THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.'\n                );\n                return geometry;\n            }\n        }\n\n        //\n\n        var numberOfTriangles = index.count - 2;\n        var newIndices = [];\n\n        if (drawMode === TriangleFanDrawMode) {\n            // gl.TRIANGLE_FAN\n\n            for (var i = 1; i <= numberOfTriangles; i++) {\n                newIndices.push(index.getX(0));\n                newIndices.push(index.getX(i));\n                newIndices.push(index.getX(i + 1));\n            }\n        } else {\n            // gl.TRIANGLE_STRIP\n\n            for (var i = 0; i < numberOfTriangles; i++) {\n                if (i % 2 === 0) {\n                    newIndices.push(index.getX(i));\n                    newIndices.push(index.getX(i + 1));\n                    newIndices.push(index.getX(i + 2));\n                } else {\n                    newIndices.push(index.getX(i + 2));\n                    newIndices.push(index.getX(i + 1));\n                    newIndices.push(index.getX(i));\n                }\n            }\n        }\n\n        if (newIndices.length / 3 !== numberOfTriangles) {\n            console.error('THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.');\n        }\n\n        // build final geometry\n\n        var newGeometry = geometry.clone();\n        newGeometry.setIndex(newIndices);\n\n        return newGeometry;\n    }\n\n    /**\n     * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n     *\n     * Creates BufferGeometries from primitives.\n     *\n     * @param {Array<GLTF.Primitive>} primitives\n     * @return {Promise<Array<BufferGeometry>>}\n     */\n    GLTFParser.prototype.loadGeometries = function (primitives) {\n        var parser = this;\n        var extensions = this.extensions;\n        var cache = this.primitiveCache;\n\n        function createDracoPrimitive(primitive) {\n            return extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]\n                .decodePrimitive(primitive, parser)\n                .then(function (geometry) {\n                    return addPrimitiveAttributes(geometry, primitive, parser);\n                });\n        }\n\n        var pending = [];\n\n        for (var i = 0, il = primitives.length; i < il; i++) {\n            var primitive = primitives[i];\n            var cacheKey = createPrimitiveKey(primitive);\n\n            // See if we've already created this geometry\n            var cached = cache[cacheKey];\n\n            if (cached) {\n                // Use the cached geometry if it exists\n                pending.push(cached.promise);\n            } else {\n                var geometryPromise;\n\n                if (primitive.extensions && primitive.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]) {\n                    // Use DRACO geometry if available\n                    geometryPromise = createDracoPrimitive(primitive);\n                } else {\n                    // Otherwise create a new geometry\n                    geometryPromise = addPrimitiveAttributes(new BufferGeometry(), primitive, parser);\n                }\n\n                // Cache this geometry\n                cache[cacheKey] = { primitive: primitive, promise: geometryPromise };\n\n                pending.push(geometryPromise);\n            }\n        }\n\n        return Promise.all(pending);\n    };\n\n    /**\n     * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n     * @param {number} meshIndex\n     * @return {Promise<Group|Mesh|SkinnedMesh>}\n     */\n    GLTFParser.prototype.loadMesh = function (meshIndex) {\n        var parser = this;\n        var json = this.json;\n\n        var meshDef = json.meshes[meshIndex];\n        var primitives = meshDef.primitives;\n\n        var pending = [];\n\n        for (var i = 0, il = primitives.length; i < il; i++) {\n            var material =\n                primitives[i].material === undefined\n                    ? createDefaultMaterial(this.cache)\n                    : this.getDependency('material', primitives[i].material);\n\n            pending.push(material);\n        }\n\n        pending.push(parser.loadGeometries(primitives));\n\n        return Promise.all(pending).then(function (results) {\n            var materials = results.slice(0, results.length - 1);\n            var geometries = results[results.length - 1];\n\n            var meshes = [];\n\n            for (var i = 0, il = geometries.length; i < il; i++) {\n                var geometry = geometries[i];\n                var primitive = primitives[i];\n\n                // 1. create Mesh\n\n                var mesh;\n\n                var material = materials[i];\n\n                if (\n                    primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\n                    primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\n                    primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\n                    primitive.mode === undefined\n                ) {\n                    // .isSkinnedMesh isn't in glTF spec. See .markDefs()\n                    mesh =\n                        meshDef.isSkinnedMesh === true\n                            ? new SkinnedMesh(geometry, material)\n                            : new Mesh(geometry, material);\n\n                    if (mesh.isSkinnedMesh === true && !mesh.geometry.attributes.skinWeight.normalized) {\n                        // we normalize floating point skin weight array to fix malformed assets (see #15319)\n                        // it's important to skip this for non-float32 data since normalizeSkinWeights assumes non-normalized inputs\n                        mesh.normalizeSkinWeights();\n                    }\n\n                    if (primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP) {\n                        mesh.geometry = toTrianglesDrawMode(mesh.geometry, TriangleStripDrawMode);\n                    } else if (primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN) {\n                        mesh.geometry = toTrianglesDrawMode(mesh.geometry, TriangleFanDrawMode);\n                    }\n                } else if (primitive.mode === WEBGL_CONSTANTS.LINES) {\n                    mesh = new LineSegments(geometry, material);\n                } else if (primitive.mode === WEBGL_CONSTANTS.LINE_STRIP) {\n                    mesh = new Line(geometry, material);\n                } else if (primitive.mode === WEBGL_CONSTANTS.LINE_LOOP) {\n                    mesh = new LineLoop(geometry, material);\n                } else if (primitive.mode === WEBGL_CONSTANTS.POINTS) {\n                    mesh = new Points(geometry, material);\n                } else {\n                    throw new Error('THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode);\n                }\n\n                if (Object.keys(mesh.geometry.morphAttributes).length > 0) {\n                    updateMorphTargets(mesh, meshDef);\n                }\n\n                mesh.name = meshDef.name || 'mesh_' + meshIndex;\n\n                if (geometries.length > 1) mesh.name += '_' + i;\n\n                assignExtrasToUserData(mesh, meshDef);\n\n                parser.assignFinalMaterial(mesh);\n\n                meshes.push(mesh);\n            }\n\n            if (meshes.length === 1) {\n                return meshes[0];\n            }\n\n            var group = new Group();\n\n            for (var i = 0, il = meshes.length; i < il; i++) {\n                group.add(meshes[i]);\n            }\n\n            return group;\n        });\n    };\n\n    /**\n     * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n     * @param {number} cameraIndex\n     * @return {Promise<THREE.Camera>}\n     */\n    GLTFParser.prototype.loadCamera = function (cameraIndex) {\n        var camera;\n        var cameraDef = this.json.cameras[cameraIndex];\n        var params = cameraDef[cameraDef.type];\n\n        if (!params) {\n            console.warn('THREE.GLTFLoader: Missing camera parameters.');\n            return;\n        }\n\n        if (cameraDef.type === 'perspective') {\n            camera = new PerspectiveCamera(\n                MathUtils.radToDeg(params.yfov),\n                params.aspectRatio || 1,\n                params.znear || 1,\n                params.zfar || 2e6\n            );\n        } else if (cameraDef.type === 'orthographic') {\n            camera = new OrthographicCamera(\n                -params.xmag,\n                params.xmag,\n                params.ymag,\n                -params.ymag,\n                params.znear,\n                params.zfar\n            );\n        }\n\n        if (cameraDef.name) camera.name = cameraDef.name;\n\n        assignExtrasToUserData(camera, cameraDef);\n\n        return Promise.resolve(camera);\n    };\n\n    /**\n     * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n     * @param {number} skinIndex\n     * @return {Promise<Object>}\n     */\n    GLTFParser.prototype.loadSkin = function (skinIndex) {\n        var skinDef = this.json.skins[skinIndex];\n\n        var skinEntry = { joints: skinDef.joints };\n\n        if (skinDef.inverseBindMatrices === undefined) {\n            return Promise.resolve(skinEntry);\n        }\n\n        return this.getDependency('accessor', skinDef.inverseBindMatrices).then(function (accessor) {\n            skinEntry.inverseBindMatrices = accessor;\n\n            return skinEntry;\n        });\n    };\n\n    /**\n     * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n     * @param {number} animationIndex\n     * @return {Promise<AnimationClip>}\n     */\n    GLTFParser.prototype.loadAnimation = function (animationIndex) {\n        var json = this.json;\n\n        var animationDef = json.animations[animationIndex];\n\n        var pendingNodes = [];\n        var pendingInputAccessors = [];\n        var pendingOutputAccessors = [];\n        var pendingSamplers = [];\n        var pendingTargets = [];\n\n        for (var i = 0, il = animationDef.channels.length; i < il; i++) {\n            var channel = animationDef.channels[i];\n            var sampler = animationDef.samplers[channel.sampler];\n            var target = channel.target;\n            var name = target.node !== undefined ? target.node : target.id; // NOTE: target.id is deprecated.\n            var input = animationDef.parameters !== undefined ? animationDef.parameters[sampler.input] : sampler.input;\n            var output =\n                animationDef.parameters !== undefined ? animationDef.parameters[sampler.output] : sampler.output;\n\n            pendingNodes.push(this.getDependency('node', name));\n            pendingInputAccessors.push(this.getDependency('accessor', input));\n            pendingOutputAccessors.push(this.getDependency('accessor', output));\n            pendingSamplers.push(sampler);\n            pendingTargets.push(target);\n        }\n\n        return Promise.all([\n            Promise.all(pendingNodes),\n            Promise.all(pendingInputAccessors),\n            Promise.all(pendingOutputAccessors),\n            Promise.all(pendingSamplers),\n            Promise.all(pendingTargets)\n        ]).then(function (dependencies) {\n            var nodes = dependencies[0];\n            var inputAccessors = dependencies[1];\n            var outputAccessors = dependencies[2];\n            var samplers = dependencies[3];\n            var targets = dependencies[4];\n\n            var tracks = [];\n\n            for (var i = 0, il = nodes.length; i < il; i++) {\n                var node = nodes[i];\n                var inputAccessor = inputAccessors[i];\n                var outputAccessor = outputAccessors[i];\n                var sampler = samplers[i];\n                var target = targets[i];\n\n                if (node === undefined) continue;\n\n                node.updateMatrix();\n                node.matrixAutoUpdate = true;\n\n                var TypedKeyframeTrack;\n\n                switch (PATH_PROPERTIES[target.path]) {\n                    case PATH_PROPERTIES.weights:\n                        TypedKeyframeTrack = NumberKeyframeTrack;\n                        break;\n\n                    case PATH_PROPERTIES.rotation:\n                        TypedKeyframeTrack = QuaternionKeyframeTrack;\n                        break;\n\n                    case PATH_PROPERTIES.position:\n                    case PATH_PROPERTIES.scale:\n                    default:\n                        TypedKeyframeTrack = VectorKeyframeTrack;\n                        break;\n                }\n\n                var targetName = node.name ? node.name : node.uuid;\n\n                var interpolation =\n                    sampler.interpolation !== undefined ? INTERPOLATION[sampler.interpolation] : InterpolateLinear;\n\n                var targetNames = [];\n\n                if (PATH_PROPERTIES[target.path] === PATH_PROPERTIES.weights) {\n                    // Node may be a Group (glTF mesh with several primitives) or a Mesh.\n                    node.traverse(function (object) {\n                        if (object.isMesh === true && object.morphTargetInfluences) {\n                            targetNames.push(object.name ? object.name : object.uuid);\n                        }\n                    });\n                } else {\n                    targetNames.push(targetName);\n                }\n\n                var outputArray = outputAccessor.array;\n\n                if (outputAccessor.normalized) {\n                    var scale;\n\n                    if (outputArray.constructor === Int8Array) {\n                        scale = 1 / 127;\n                    } else if (outputArray.constructor === Uint8Array) {\n                        scale = 1 / 255;\n                    } else if (outputArray.constructor == Int16Array) {\n                        scale = 1 / 32767;\n                    } else if (outputArray.constructor === Uint16Array) {\n                        scale = 1 / 65535;\n                    } else {\n                        throw new Error('THREE.GLTFLoader: Unsupported output accessor component type.');\n                    }\n\n                    var scaled = new Float32Array(outputArray.length);\n\n                    for (var j = 0, jl = outputArray.length; j < jl; j++) {\n                        scaled[j] = outputArray[j] * scale;\n                    }\n\n                    outputArray = scaled;\n                }\n\n                for (var j = 0, jl = targetNames.length; j < jl; j++) {\n                    var track = new TypedKeyframeTrack(\n                        targetNames[j] + '.' + PATH_PROPERTIES[target.path],\n                        inputAccessor.array,\n                        outputArray,\n                        interpolation\n                    );\n\n                    // Override interpolation with custom factory method.\n                    if (sampler.interpolation === 'CUBICSPLINE') {\n                        track.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline(result) {\n                            // A CUBICSPLINE keyframe in glTF has three output values for each input value,\n                            // representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n                            // must be divided by three to get the interpolant's sampleSize argument.\n\n                            return new GLTFCubicSplineInterpolant(\n                                this.times,\n                                this.values,\n                                this.getValueSize() / 3,\n                                result\n                            );\n                        };\n\n                        // Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\n                        track.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\n                    }\n\n                    tracks.push(track);\n                }\n            }\n\n            var name = animationDef.name ? animationDef.name : 'animation_' + animationIndex;\n\n            return new AnimationClip(name, undefined, tracks);\n        });\n    };\n\n    /**\n     * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n     * @param {number} nodeIndex\n     * @return {Promise<Object3D>}\n     */\n    GLTFParser.prototype.loadNode = function (nodeIndex) {\n        var json = this.json;\n        var extensions = this.extensions;\n        var parser = this;\n\n        var meshReferences = json.meshReferences;\n        var meshUses = json.meshUses;\n\n        var nodeDef = json.nodes[nodeIndex];\n\n        return (function () {\n            var pending = [];\n\n            if (nodeDef.mesh !== undefined) {\n                pending.push(\n                    parser.getDependency('mesh', nodeDef.mesh).then(function (mesh) {\n                        var node;\n\n                        if (meshReferences[nodeDef.mesh] > 1) {\n                            var instanceNum = meshUses[nodeDef.mesh]++;\n\n                            node = mesh.clone();\n                            node.name += '_instance_' + instanceNum;\n                        } else {\n                            node = mesh;\n                        }\n\n                        // if weights are provided on the node, override weights on the mesh.\n                        if (nodeDef.weights !== undefined) {\n                            node.traverse(function (o) {\n                                if (!o.isMesh) return;\n\n                                for (var i = 0, il = nodeDef.weights.length; i < il; i++) {\n                                    o.morphTargetInfluences[i] = nodeDef.weights[i];\n                                }\n                            });\n                        }\n\n                        return node;\n                    })\n                );\n            }\n\n            if (nodeDef.camera !== undefined) {\n                pending.push(parser.getDependency('camera', nodeDef.camera));\n            }\n\n            if (\n                nodeDef.extensions &&\n                nodeDef.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL] &&\n                nodeDef.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL].light !== undefined\n            ) {\n                pending.push(parser.getDependency('light', nodeDef.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL].light));\n            }\n\n            return Promise.all(pending);\n        })().then(function (objects) {\n            var node;\n\n            // .isBone isn't in glTF spec. See .markDefs\n            if (nodeDef.isBone === true) {\n                node = new Bone();\n            } else if (objects.length > 1) {\n                node = new Group();\n            } else if (objects.length === 1) {\n                node = objects[0];\n            } else {\n                node = new Object3D();\n            }\n\n            if (node !== objects[0]) {\n                for (var i = 0, il = objects.length; i < il; i++) {\n                    node.add(objects[i]);\n                }\n            }\n\n            if (nodeDef.name) {\n                node.userData.name = nodeDef.name;\n                node.name = PropertyBinding.sanitizeNodeName(nodeDef.name);\n            }\n\n            assignExtrasToUserData(node, nodeDef);\n\n            if (nodeDef.extensions) addUnknownExtensionsToUserData(extensions, node, nodeDef);\n\n            if (nodeDef.matrix !== undefined) {\n                var matrix = new Matrix4();\n                matrix.fromArray(nodeDef.matrix);\n                node.applyMatrix4(matrix);\n            } else {\n                if (nodeDef.translation !== undefined) {\n                    node.position.fromArray(nodeDef.translation);\n                }\n\n                if (nodeDef.rotation !== undefined) {\n                    node.quaternion.fromArray(nodeDef.rotation);\n                }\n\n                if (nodeDef.scale !== undefined) {\n                    node.scale.fromArray(nodeDef.scale);\n                }\n            }\n\n            return node;\n        });\n    };\n\n    /**\n     * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n     * @param {number} sceneIndex\n     * @return {Promise<Group>}\n     */\n    GLTFParser.prototype.loadScene = (function () {\n        // scene node hierachy builder\n\n        function buildNodeHierachy(nodeId, parentObject, json, parser) {\n            var nodeDef = json.nodes[nodeId];\n\n            return parser\n                .getDependency('node', nodeId)\n                .then(function (node) {\n                    if (nodeDef.skin === undefined) return node;\n\n                    // build skeleton here as well\n\n                    var skinEntry;\n\n                    return parser\n                        .getDependency('skin', nodeDef.skin)\n                        .then(function (skin) {\n                            skinEntry = skin;\n\n                            var pendingJoints = [];\n\n                            for (var i = 0, il = skinEntry.joints.length; i < il; i++) {\n                                pendingJoints.push(parser.getDependency('node', skinEntry.joints[i]));\n                            }\n\n                            return Promise.all(pendingJoints);\n                        })\n                        .then(function (jointNodes) {\n                            node.traverse(function (mesh) {\n                                if (!mesh.isMesh) return;\n\n                                var bones = [];\n                                var boneInverses = [];\n\n                                for (var j = 0, jl = jointNodes.length; j < jl; j++) {\n                                    var jointNode = jointNodes[j];\n\n                                    if (jointNode) {\n                                        bones.push(jointNode);\n\n                                        var mat = new Matrix4();\n\n                                        if (skinEntry.inverseBindMatrices !== undefined) {\n                                            mat.fromArray(skinEntry.inverseBindMatrices.array, j * 16);\n                                        }\n\n                                        boneInverses.push(mat);\n                                    } else {\n                                        console.warn(\n                                            'THREE.GLTFLoader: Joint \"%s\" could not be found.',\n                                            skinEntry.joints[j]\n                                        );\n                                    }\n                                }\n\n                                mesh.bind(new Skeleton(bones, boneInverses), mesh.matrixWorld);\n                            });\n\n                            return node;\n                        });\n                })\n                .then(function (node) {\n                    // build node hierachy\n\n                    parentObject.add(node);\n\n                    var pending = [];\n\n                    if (nodeDef.children) {\n                        var children = nodeDef.children;\n\n                        for (var i = 0, il = children.length; i < il; i++) {\n                            var child = children[i];\n                            pending.push(buildNodeHierachy(child, node, json, parser));\n                        }\n                    }\n\n                    return Promise.all(pending);\n                });\n        }\n\n        return function loadScene(sceneIndex) {\n            var json = this.json;\n            var extensions = this.extensions;\n            var sceneDef = this.json.scenes[sceneIndex];\n            var parser = this;\n\n            // Loader returns Group, not Scene.\n            // See: https://github.com/mrdoob/three.js/issues/18342#issuecomment-578981172\n            var scene = new Group();\n            if (sceneDef.name) scene.name = sceneDef.name;\n\n            assignExtrasToUserData(scene, sceneDef);\n\n            if (sceneDef.extensions) addUnknownExtensionsToUserData(extensions, scene, sceneDef);\n\n            var nodeIds = sceneDef.nodes || [];\n\n            var pending = [];\n\n            for (var i = 0, il = nodeIds.length; i < il; i++) {\n                pending.push(buildNodeHierachy(nodeIds[i], scene, json, parser));\n            }\n\n            return Promise.all(pending).then(function () {\n                return scene;\n            });\n        };\n    })();\n\n    return GLTFLoader;\n})();\n\nexport { GLTFLoader };\n","const ALIAS = {\n    left: 37,\n    up: 38,\n    right: 39,\n    down: 40,\n    space: 32,\n    tab: 9,\n    escape: 27\n};\n\nexport default class Keyboard {\n    constructor(domElement) {\n        this.domElement = domElement || document;\n        this.keyCodes = {};\n\n        // bind keyEvents\n        this.domElement.addEventListener('keydown', (event) => this.onKeyChange(event), false);\n        this.domElement.addEventListener('keyup', (event) => this.onKeyChange(event), false);\n\n        // bind window blur\n        window.addEventListener('blur', () => this.onBlur, false);\n    }\n\n    destroy() {\n        this.domElement.removeEventListener('keydown', (event) => this.onKeyChange(event), false);\n        this.domElement.removeEventListener('keyup', (event) => this.onKeyChange(event), false);\n\n        // unbind window blur event\n        window.removeEventListener('blur', () => this.onBlur, false);\n    }\n\n    onBlur() {\n        for (const prop in this.keyCodes) this.keyCodes[prop] = false;\n    }\n\n    onKeyChange(event) {\n        // log to debug\n        //console.log('onKeyChange', event, event.keyCode, event.shiftKey, event.ctrlKey, event.altKey, event.metaKey)\n\n        // update this.keyCodes\n        const keyCode = event.keyCode;\n        this.keyCodes[keyCode] = event.type === 'keydown';\n    }\n\n    pressed(keyDesc) {\n        const keys = keyDesc.split('+');\n        for (let i = 0; i < keys.length; i++) {\n            const key = keys[i];\n            let pressed = false;\n            if (Object.keys(ALIAS).indexOf(key) != -1) {\n                pressed = this.keyCodes[ALIAS[key]];\n            } else {\n                pressed = this.keyCodes[key.toUpperCase().charCodeAt(0)];\n            }\n            if (!pressed) return false;\n        }\n\n        return true;\n    }\n\n    eventMatches(event, keyDesc) {\n        const aliases = ALIAS;\n        const aliasKeys = Object.keys(aliases);\n        const keys = keyDesc.split('+');\n        // log to debug\n        // console.log('eventMatches', event, event.keyCode, event.shiftKey, event.ctrlKey, event.altKey, event.metaKey)\n        for (let i = 0; i < keys.length; i++) {\n            const key = keys[i];\n            let pressed = false;\n            if (key === 'shift') {\n                pressed = event.shiftKey ? true : false;\n            } else if (key === 'ctrl') {\n                pressed = event.ctrlKey ? true : false;\n            } else if (key === 'alt') {\n                pressed = event.altKey ? true : false;\n            } else if (key === 'meta') {\n                pressed = event.metaKey ? true : false;\n            } else if (aliasKeys.indexOf(key) !== -1) {\n                pressed = event.keyCode === aliases[key];\n            } else if (event.keyCode === key.toUpperCase().charCodeAt(0)) {\n                pressed = true;\n            }\n            if (!pressed) return false;\n        }\n\n        return true;\n    }\n}\n","import Keyboard from '../../utils/keyboard';\nimport Helpers from '../../utils/helpers';\nimport Config from '../../data/config';\n\n// Manages all input interactions\nexport default class Interaction {\n    constructor(renderer, scene, camera, controls) {\n        // Properties\n        this.renderer = renderer;\n        this.scene = scene;\n        this.camera = camera;\n        this.controls = controls;\n\n        this.timeout = null;\n\n        // Instantiate keyboard helper\n        this.keyboard = new Keyboard();\n\n        // Listeners\n        // Mouse events\n        this.renderer.domElement.addEventListener(\n            'mousemove',\n            (event) => Helpers.throttle(this.onMouseMove(event), 250),\n            false\n        );\n        this.renderer.domElement.addEventListener('mouseleave', (event) => this.onMouseLeave(event), false);\n        this.renderer.domElement.addEventListener('mouseover', (event) => this.onMouseOver(event), false);\n\n        // Keyboard events\n        this.keyboard.domElement.addEventListener('keydown', (event) => {\n            // Only once\n            if (event.repeat) {\n                return;\n            }\n\n            if (this.keyboard.eventMatches(event, 'escape')) {\n                console.log('Escape pressed');\n            }\n        });\n    }\n\n    onMouseOver(event) {\n        event.preventDefault();\n\n        Config.isMouseOver = true;\n    }\n\n    onMouseLeave(event) {\n        event.preventDefault();\n\n        Config.isMouseOver = false;\n    }\n\n    onMouseMove(event) {\n        event.preventDefault();\n\n        clearTimeout(this.timeout);\n\n        this.timeout = setTimeout(function () {\n            Config.isMouseMoving = false;\n        }, 200);\n\n        Config.isMouseMoving = true;\n    }\n}\n","import Config from '../../data/config';\nconst storedConfig = window.localStorage;\nconsole.log('storedConfig', storedConfig, JSON.parse(storedConfig.getItem(`${window.location.href}.gui`)));\n\n// COMMENT(NuwanJ)\n// Store the last state of the toggles in the window.localStorage\n// Refer: https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage\n// Refer: https://github.com/dataarts/dat.gui/blob/master/API.md#GUI+useLocalStorage\n\nlet realities = {\n    physical: true,\n    virtual: true\n};\n\n// Manages all dat.GUI interactions\nexport default class DatGUI {\n    constructor(main) {\n        this.gui = new dat.GUI();\n\n        this.gui.useLocalStorage = true;\n\n        this.camera = main.camera.threeCamera;\n        this.controls = main.controls.threeControls;\n        this.light = main.light;\n        this.scene = main.scene;\n\n        this.model = null;\n        this.meshHelper = null;\n    }\n\n    load(main, mesh) {\n        // Add folders\n        this.gui.add(Config, 'isShowingRobotSnapshots').name('Robot Snapshots');\n        /* Labels Folder */\n        const labelsFolder = this.gui.addFolder('Labels');\n        labelsFolder.add(Config, 'isShowingLables').name('All Labels');\n\n        labelsFolder\n            .add(Config.labelsVisibility, 'obstacles')\n            .name('Obstacle Labels')\n            .onChange((value) => {\n                this.toggleLabels(this.scene.children, 'Obstacle', value);\n            });\n        labelsFolder\n            .add(Config.labelsVisibility, 'robots')\n            .name('Robot Labels')\n            .onChange((value) => {\n                this.toggleLabels(this.scene.children, 'Robot', value);\n            });\n\n        /* Reality Folder */\n        const realityFolder = this.gui.addFolder('Reality');\n\n        // TODO: mixed reality = p + v\n        // No need of additional toggle\n        realityFolder\n            .add(realities, 'physical')\n            .name('Physical Reality')\n            .listen()\n            .onChange((value) => {\n                this.toggleReality('physical', 'P');\n            });\n        realityFolder\n            .add(realities, 'virtual')\n            .name('Virtual Reality')\n            .listen()\n            .onChange((value) => {\n                this.toggleReality('virtual', 'V');\n            });\n\n        this.gui.open();\n\n        /* Global */\n        //this.gui.close();\n\n        // this.model = main.model;\n        // this.meshHelper = main.meshHelper;\n    }\n\n    toggleLabels(objects, type, value) {\n        if (Array.isArray(objects) && type !== undefined && type !== '') {\n            for (var variable of objects) {\n                if (variable.name.startsWith(type)) {\n                    variable.children[0].visible = value;\n                }\n            }\n        }\n    }\n\n    toggleRobotsByRealm(objects, type) {\n        if (Array.isArray(objects) && type !== undefined && type !== '') {\n            for (let variable of objects) {\n                // TODO:\n            }\n        }\n    }\n\n    toggleReality(reality, selected) {\n        // TODO: refer Config.mixedReality for actual changes\n        // by default visualizer will intercept all the communication coming to the channel regardless of the reality.\n        // this control panel will only toggle the visibility of objects in the selected realities.\n        const objects = scene.children;\n        Object.entries(objects).forEach((obj) => {\n            const name = obj[1]['name'];\n            const reality = obj[1]['reality'];\n\n            if (reality != undefined) {\n                // TODO: hide by making opacity = 0 for non-matched obstacles\n                // or any other solution\n                // obj[1].material.opacity = 0;\n            }\n        });\n\n        window.selectedReality = selected;\n        for (let attrib in realities) {\n            realities[attrib] = false;\n        }\n        realities[reality] = true;\n        console.log(window.selectedReality, realities);\n    }\n\n    show() {\n        this.gui.show();\n    }\n\n    unload() {\n        this.gui.destroy();\n        this.gui = new dat.GUI();\n    }\n}\n","import * as THREE from 'three';\n\nimport Config from '../../data/config';\nimport { addLabel, removeLabel } from './label';\n\nconst OBSTACLE_PREFIX = 'Obstacle_';\n\nexport default class Obstacle {\n    constructor(scene, callback) {\n        this.scene = scene;\n        console.log('Obstacle Reality:', Config.mixedReality.obstacles);\n\n        if (callback !== undefined) {\n            callback();\n        }\n    }\n\n    // Create a given list of obstacles\n    createList(obstacles) {\n        Object.entries(obstacles).forEach((obs) => {\n            if (obs !== undefined) {\n                //console.log(obs[1]);\n                this.create(obs[1]);\n            }\n        });\n    }\n\n    // Create a obstacle\n    create(obstacle) {\n        const geometry = this.createGeometry(obstacle.geometry);\n        const material = this.createMaterial(obstacle.material);\n        material.userData.originalColor = new THREE.Color(0x666666);\n        material.userData.labelVisibility = Config.isShowingLables && Config.labelsVisibility.obstacles;\n        material.userData.originalEmmisive = material.emissive.getHex();\n        material.selected = false;\n        const id = obstacle.id || 1000 + Math.floor(900 * Math.random());\n\n        const reality = obstacle.reality == undefined ? 'V' : obstacle.reality;\n        const mesh = new THREE.Mesh(geometry, material);\n\n        mesh.name = OBSTACLE_PREFIX + id;\n        mesh.reality = reality; // set reality flag\n\n        // TODO: set visibility according to the Config.mixedReality.obstacles\n\n        // Remove if object is already defined\n        this.deleteIfExists(id);\n\n        // Add the mesh object to arena\n        this.scene.add(mesh);\n\n        // update the position of the object\n        if (obstacle.position !== undefined) {\n            const { x, y } = obstacle.position;\n            const z = this.calculateZ(obstacle);\n\n            mesh.scale.set(scene_scale, scene_scale, scene_scale);\n            mesh.position.set(scene_scale * x, scene_scale * y, scene_scale * z);\n        }\n\n        // Rotate the object, after translate degrees into radians\n        if (obstacle.rotation !== undefined) {\n            const { x, y, z } = obstacle.rotation;\n            const radX = ((90 + x) / 360) * 2 * Math.PI; // transformation due to coordinate system\n            const radY = (y / 360) * 2 * Math.PI;\n            const radZ = (z / 360) * 2 * Math.PI;\n\n            mesh.rotation.set(radX, radY, radZ);\n        }\n\n        // Show shadows of the object if enabled\n        if (Config.shadow.enabled) mesh.receiveShadow = true;\n\n        // Add labels to every obstacle, immediately displayed if enabled\n\n        addLabel(OBSTACLE_PREFIX, obstacle, mesh, Config.labelsVisibility.obstacles);\n\n        console.log('Created>', mesh.name);\n    }\n\n    createGeometry(g) {\n        if (g.type == undefined) throw new TypeError('type unspecified');\n\n        if (g.type == 'BoxGeometry') {\n            return this.createBoxGeometry(g.width, g.height, g.depth);\n        } else if (g.type == 'CylinderGeometry') {\n            return this.createCylinderGeometry(g.radiusTop, g.radiusBottom, g.height);\n        } else if (g.type == 'SphereGeometry') {\n            return this.createSphereGeometry(g.radius);\n        } else {\n            throw new TypeError('unsupported geometry type');\n        }\n    }\n\n    createBoxGeometry(width, height, depth) {\n        if (width == undefined) throw new TypeError('width unspecified');\n        if (height == undefined) throw new TypeError('height unspecified');\n        if (depth == undefined) throw new TypeError('depth unspecified');\n\n        // https://threejs.org/docs/#api/en/geometries/BoxGeometry\n        return new THREE.BoxGeometry(width, height, depth);\n    }\n\n    createCylinderGeometry(radiusTop, radiusBottom, height) {\n        if (radiusTop == undefined) throw new TypeError('radiusTop unspecified');\n        if (radiusBottom == undefined) throw new TypeError('radiusBottom unspecified');\n        if (height == undefined) throw new TypeError('height unspecified');\n\n        // https://threejs.org/docs/#api/en/geometries/CylinderGeometry\n        const heightSegments = heightSegments || 2;\n        const radialSegments = radialSegments || 16;\n\n        return new THREE.CylinderGeometry(radiusTop, radiusBottom, height, radialSegments, heightSegments);\n    }\n\n    createSphereGeometry(radius) {\n        if (radius == undefined) throw new TypeError('radius unspecified');\n\n        // https://threejs.org/docs/#api/en/geometries/SphereGeometry\n        const widthSegments = widthSegments || 16;\n        const heightSegments = heightSegments || 16;\n        return new THREE.SphereGeometry(radius, widthSegments, heightSegments);\n    }\n\n    createMaterial(m) {\n        let material;\n        if (m.type == 'MeshBasicMaterial') {\n            // https://threejs.org/docs/#api/en/materials/MeshBasicMaterial\n            return new THREE.MeshBasicMaterial(m.properties);\n        } else if (m.type == 'MeshNormalMaterial') {\n            // https://threejs.org/docs/api/en/materials/MeshNormalMaterial.html\n            return new THREE.MeshNormalMaterial(m.properties);\n        } else if (m.type == 'MeshPhongMaterial') {\n            // https://threejs.org/docs/#api/en/materials/MeshPhongMaterial\n            return new THREE.MeshPhongMaterial(m.properties);\n        } else if (m.type == 'MeshPhysicalMaterial') {\n            // https://threejs.org/docs/#api/en/materials/MeshPhysicalMaterial\n            return new THREE.MeshPhysicalMaterial(m.properties);\n        } else if (m.type == 'MeshStandardMaterial') {\n            // https://threejs.org/docs/#api/en/materials/MeshStandardMaterial\n            return new THREE.MeshStandardMaterial(m.properties);\n        } else {\n            // Default material type\n            return new THREE.MeshStandardMaterial(m.properties);\n        }\n    }\n\n    calculateZ(obstacle) {\n        // If z is undefined, place the object in top of the arena\n        if (obstacle.position.z == undefined) {\n            if (obstacle.geometry.height !== undefined) {\n                // Box and Cylinder objects\n                return obstacle.geometry.height / 2;\n            } else if (obstacle.geometry.radius !== undefined) {\n                // Sphere objects\n                return obstacle.geometry.radius;\n            } else {\n                return 0;\n            }\n        }\n        return obstacle.position.z;\n    }\n\n    deleteIfExists(id) {\n        // Delete obstacle if it already exists\n        const name = OBSTACLE_PREFIX + id;\n        const obstacle = this.scene.getObjectByName(name);\n        if (obstacle !== undefined) {\n            this.scene.remove(obstacle);\n            console.log('Deleted>', name);\n        }\n    }\n\n    deleteAll() {\n        // Delete all obstacles\n        const objects = this.scene.children;\n        Object.entries(objects).forEach((obj) => {\n            const name = obj[1]['name'];\n            if (name.startsWith(OBSTACLE_PREFIX)) {\n                console.log('Deleted>', name);\n                removeLabel(obj[1]);\n                this.scene.remove(obj[1]);\n            }\n        });\n    }\n}\n","import * as THREE from 'three';\nimport TWEEN, { update } from '@tweenjs/tween.js';\n\nimport Config from '../../data/config';\nimport { addLabel, removeLabel } from './label';\n\nvar STLLoader = require('three-stl-loader')(THREE);\n\nconst ROBOT_PREFIX = 'Robot_';\n\nexport default class Robot {\n    constructor(scene) {\n        this.scene = scene;\n        console.log('Robot Reality:', Config.mixedReality.robots);\n    }\n\n    changeColor(id, R, G, B, ambient, callback) {\n        var r = this.scene.getObjectByName(ROBOT_PREFIX + id);\n        if (r != undefined) {\n            r.material.color.setRGB(R / 256, G / 256, B / 265);\n            //console.log(\"Color> id:\", id, \" | R:\", R, \"G:\", G, \"B:\", B);\n\n            if (callback != null) callback('success');\n        } else {\n            if (callback != null) callback('undefined');\n        }\n\n        return r;\n    }\n\n    create(id, x, y, heading, reality = 'V', callback) {\n        var r = this.scene.getObjectByName(ROBOT_PREFIX + id);\n        const REALITY = Config.mixedReality.robots;\n\n        if (r == undefined) {\n            // Create only if not exists\n\n            if (reality === REALITY || REALITY === 'M') {\n                // Can create\n                // Limit the arena that robot can go\n                x = scene_scale * Math.min(Math.max(x, Config.arena.minX), Config.arena.maxX);\n                y = scene_scale * Math.min(Math.max(y, Config.arena.minY), Config.arena.maxY);\n\n                var loader = new STLLoader();\n                loader.load('./assets/models/model.stl', function (geometry, scene) {\n                    // Set less opacity for virtual robots\n                    const opacity = 1; // reality == 'V' ? 0.5 : 1;\n\n                    const material = new THREE.MeshStandardMaterial({\n                        color: 0x666666,\n                        opacity: opacity,\n                        transparent: true\n                    });\n                    material.userData.originalColor = new THREE.Color(0x666666);\n                    material.userData.labelVisibility = Config.isShowingLables && Config.labelsVisibility.robots;\n                    material.selected = false;\n                    var r = new THREE.Mesh(geometry, material);\n                    r.receiveShadow = true;\n                    r.robotId = id;\n                    r.name = ROBOT_PREFIX + id;\n                    r.scale.set(scene_scale, scene_scale, scene_scale);\n                    r.position.set(x, y, 0);\n                    r.rotation.x = 90 * THREE.Math.DEG2RAD;\n                    r.rotation.y = (heading - 90) * THREE.Math.DEG2RAD;\n                    r.reality = reality; // set reality flag\n\n                    // Add robot to the scene\n                    window.scene.add(r);\n\n                    r.clickEvent = function (m) {\n                        window.robot.alert(m);\n                    };\n\n                    // Add labels to every robot, immediately displayed if enabled\n                    addLabel(ROBOT_PREFIX, { id }, r, Config.labelsVisibility.robots);\n\n                    console.log(`Created> Robot: id:${id} | x:${x} y: ${y} heading: ${heading} | reality: ${reality}`);\n\n                    // Callback function\n                    if (callback != undefined) callback('success');\n                });\n            } else {\n                console.error(`Creation Failed> Robot: id:${id}  reality: ${reality}!=${REALITY}`);\n            }\n        } else {\n            if (reality === REALITY || REALITY === 'M') {\n                // Reality matches\n\n                this.setReality(id, reality);\n                this.move(id, x, y, heading, () => {\n                    if (callback != undefined) callback('already defined, so moved');\n                });\n            } else {\n                // Robot reality not matching with environment reality\n                this.delete(id);\n            }\n        }\n        return r;\n    }\n\n    delete(id, callback) {\n        if (id != undefined) {\n            var r = this.scene.getObjectByName(ROBOT_PREFIX + id);\n\n            if (r != undefined) {\n                scene.remove(r);\n                console.log('Deleted> id:', id);\n                if (callback != undefined) callback('success');\n            } else {\n                if (callback != undefined) callback('not found');\n            }\n        } else {\n            if (callback != undefined) callback('id not specified');\n        }\n    }\n\n    deleteAll() {\n        // Delete all robots\n        const objects = this.scene.children;\n\n        Object.entries(objects).forEach((obj) => {\n            const name = obj[1]['name'];\n\n            if (name.startsWith(ROBOT_PREFIX)) {\n                console.log('Deleted>', name);\n                removeLabel(obj[1]);\n                this.scene.remove(obj[1]);\n            }\n        });\n    }\n\n    setReality(id, reality) {\n        var r = this.scene.getObjectByName(ROBOT_PREFIX + id);\n        if (r != undefined) {\n            r.reality = reality;\n        }\n    }\n    exists(id) {\n        var r = this.scene.getObjectByName(ROBOT_PREFIX + id);\n        return r;\n    }\n\n    move(id, x, y, heading, callback) {\n        var r = this.scene.getObjectByName(ROBOT_PREFIX + id);\n        if (r != undefined) {\n            const currentHeading = r.rotation.y;\n            const newHeading = (heading - 90) * THREE.Math.DEG2RAD;\n            var position = { x: r.position.x, y: r.position.y, heading: r.rotation.y };\n\n            // TODO: need a smoother way than this rough trick\n            // If current and target rotations in different signs\n            const rotationFlag = currentHeading * newHeading >= 0 ? true : false;\n\n            // Limit the arena that robot can go\n            x = scene_scale * Math.min(Math.max(Math.round(x * 10) / 10, Config.arena.minX), Config.arena.maxX);\n            y = scene_scale * Math.min(Math.max(Math.round(y * 10) / 10, Config.arena.minY), Config.arena.maxY);\n            heading = Math.round(heading * 10) / 10;\n\n            // const speed = 10;\n            const distance = Math.sqrt(Math.pow(x - position.x, 2) + Math.pow(y - position.y, 2));\n\n            const moveTime = 1; //distance / speed;\n            // TODO: If distance is 0, need to handle only the rotation\n\n            if (distance != 0) {\n                var tween = new TWEEN.Tween(position)\n                    .to({ x: x, y: y, heading: newHeading }, 1000 * moveTime)\n                    /*.easing(TWEEN.Easing.Quartic.InOut)*/\n                    .onUpdate(function () {\n                        r.position.x = position.x;\n                        r.position.y = position.y;\n\n                        if (rotationFlag) {\n                            r.rotation.y = position.heading;\n                        } else {\n                            //console.log(currentHeading, newHeading);\n                        }\n                    })\n                    .onComplete(() => {\n                        //console.log('Moved> id:',id,'x:',x,'y:',y,'heading:',heading);\n                        r.rotation.y = position.heading;\n                        if (callback != null) callback('success');\n                    })\n                    .delay(50)\n                    .start();\n            } else {\n                // No move, only the rotation\n                r.rotation.y = newHeading;\n            }\n            return r;\n        } else {\n            if (callback != null) callback('undefined');\n        }\n    }\n\n    get_coordinates(id) {\n        var r = this.scene.getObjectByName(ROBOT_PREFIX + id);\n        if (r != undefined) {\n            console.log(`${r.position.x},${r.position.y},${r.position.z}`);\n            return r;\n        } else {\n            return null;\n        }\n    }\n\n    update() {\n        TWEEN.update();\n    }\n\n    requestSnapshot(mesh) {\n        return new Promise((resolve, reject) => {\n            let req = window.mqtt.publish(\n                window.channel + '/mgt/robots/snapshot',\n                JSON.stringify({ id: mesh.robotId })\n            );\n            resolve(!req);\n        });\n    }\n\n    alert(mesh) {\n        // Display an alert on window\n        let disp = document.querySelector('#msg-box');\n        disp.innerHTML = `${mesh.name} [${mesh.reality}]`;\n        disp.style.display = 'block';\n        this.requestSnapshot(mesh);\n    }\n}\n","import * as THREE from 'three';\nimport TWEEN, { update } from '@tweenjs/tween.js';\nimport MQTT from 'paho-mqtt';\n\nimport Config from '../../data/config';\nimport Obstacle from '../components/obstacle';\nimport Robot from '../components/robot';\n\n// -----------------------------------------------------------------------------\n// MQTT Topics\n\n// Create and delete robot objects\nconst TOPIC_ROBOT_CREATE = 'robot/create';\nconst TOPIC_ROBOT_DELETE = 'robot/delete';\nconst TOPIC_ROBOT_BROADCAST = 'robot/msg/broadcast';\n\n// This will provide location data to the GUI\nconst TOPIC_LOC_INFO_FROM_SERVER = 'localization/data';\nconst TOPIC_LOC_INFO_FROM_LOC_SYSTEMS = 'localization/update';\n\n// This will request the localization data update from the server\nconst TOPIC_LOC_REQUEST = 'localization/data/?';\n\n// This will request obstacle data from the server\nconst TOPIC_OBSTACLE_REQUEST = 'obstacles/?';\n\n// This will send obstacle data as a JSON list\nconst TOPIC_OBSTACLES_LIST = 'obstacles';\nconst TOPIC_OBSTACLES_DELETE = 'obstacles/delete';\nconst TOPIC_OBSTACLES_DELETE_ALL = 'obstacles/delete/all';\n\n// Robot Color - NeoPixel\nconst TOPIC_CHANGE_COLOR = 'output/neopixel';\n\n// This will help to remote update the parameters in here\nconst TOPIC_MANAGEMENT_VISUALIZER = 'mgt/visualizer';\n\n// Robot management snapshot topic\nconst TOPIC_MANAGEMENT_SNAPSHOT = 'mgt/robots/?';\n\n// -----------------------------------------------------------------------------\n\nexport default class MQTTClient {\n    constructor(scene) {\n        this.scene = scene;\n        this.robot = new Robot(scene);\n        this.obstacles = new Obstacle(scene);\n\n        this.updateChannel();\n\n        // create a random client Id\n        const client_id = 'client_' + Math.random().toString(36).substring(2, 15);\n        this.client = new MQTT.Client(Config.mqtt.server, Config.mqtt.port, Config.mqtt.path, client_id);\n\n        window.mqtt = this.client;\n\n        this.client.connect({\n            userName: Config.mqtt.user,\n            password: Config.mqtt.password,\n            reconnect: true,\n            useSSL: true,\n            cleanSession: false,\n            onSuccess: () => {\n                console.log('MQTT: connected');\n\n                // Subscribe to topics\n                this.subscribe(TOPIC_LOC_INFO_FROM_SERVER);\n                this.subscribe(TOPIC_LOC_INFO_FROM_LOC_SYSTEMS);\n\n                this.subscribe(TOPIC_ROBOT_CREATE);\n                this.subscribe(TOPIC_ROBOT_DELETE);\n                this.subscribe(TOPIC_ROBOT_BROADCAST);\n\n                this.subscribe(TOPIC_CHANGE_COLOR);\n                this.subscribe(TOPIC_OBSTACLES_LIST);\n                this.subscribe(TOPIC_OBSTACLES_DELETE);\n                this.subscribe(TOPIC_OBSTACLES_DELETE_ALL);\n                this.subscribe(TOPIC_MANAGEMENT_VISUALIZER);\n                this.subscribe(TOPIC_MANAGEMENT_SNAPSHOT);\n\n                // Request for obstacle data\n                // this.publish(TOPIC_OBSTACLE_REQUEST, Config.mixedReality.obstacles);\n                this.publish(TOPIC_OBSTACLE_REQUEST, 'M');\n\n                // Request for coordinate data\n                this.publish(TOPIC_LOC_REQUEST, Config.mixedReality.robots);\n\n                // Access globally\n                window.robot = this.robot;\n                window.obstacles = this.obstacles;\n\n                this.client.onMessageArrived = this.onMessageArrived;\n                this.client.onConnectionLost = this.onConnectionLost;\n            },\n            onFailure: () => {\n                console.log('MQTT: connection failed');\n            }\n        });\n    }\n\n    updateChannel() {\n        const channelHash = window.location.hash;\n        if ((channelHash != '') & (channelHash.length > 1)) {\n            window.channel = channelHash.substring(1);\n        } else {\n            window.channel = Config.mqtt.channel;\n        }\n        console.log('MQTT: channel=', window.channel);\n        return true;\n    }\n\n    onConnectionLost(responseObject) {\n        if (responseObject.errorCode !== 0) {\n            console.log('MQTT: onConnectionLost:' + responseObject.errorMessage);\n            console.log('MQTT: reconnecting');\n        }\n    }\n\n    onMessageArrived(packet) {\n        const msg = packet.payloadString.trim();\n        const t = packet.destinationName;\n        const topic = t.substring(t.indexOf('/') + 1);\n\n        console.log('MQTT: ' + topic + ' > ' + msg);\n\n        if (topic == TOPIC_ROBOT_CREATE) {\n            try {\n                const data = JSON.parse(msg);\n                window.robot.create(data.id, data.x, data.y, data.heading, data.reality);\n            } catch (e) {\n                console.error(e);\n            }\n        } else if (topic == TOPIC_ROBOT_DELETE) {\n            try {\n                var data = JSON.parse(msg);\n                window.robot.delete(data.id);\n            } catch (e) {\n                console.error(e);\n            }\n        } else if (topic == TOPIC_LOC_INFO_FROM_LOC_SYSTEMS || topic == TOPIC_LOC_INFO_FROM_SERVER) {\n            //Data from the localization server or virtual robots\n            try {\n                const data = JSON.parse(msg);\n                const REALITY = Config.mixedReality.robots;\n\n                // Render only the received data is same as configured reality\n                // or configuration allowed mixed reality\n                if (data != undefined) {\n                    // Have data on this reality\n                    for (const i in data) {\n                        const { id, x, y, heading } = data[i];\n                        const reality = data[i].reality == undefined ? 'V' : data[i].reality;\n\n                        if (reality === REALITY || REALITY === 'M') {\n                            // Create only if robots match with platform's allowed reality\n                            if (window.robot.exists(id) == undefined) {\n                                window.robot.create(id, x, y, heading, reality);\n                            } else {\n                                window.robot.move(id, x, y, heading);\n                                window.robot.setReality(id, reality);\n                            }\n                        } else {\n                            // reality not matching; remove\n                            robot.delete(id);\n                        }\n                    }\n                }\n            } catch (e) {\n                console.error(e);\n            }\n        } else if (topic == TOPIC_OBSTACLES_LIST) {\n            // Create obstacles in the arena\n            try {\n                const data = JSON.parse(msg);\n                window.obstacles.createList(data);\n            } catch (e) {\n                console.error(e);\n            }\n        } else if (topic == TOPIC_OBSTACLES_DELETE) {\n            // Delete obstacle given in the id\n            const data = JSON.parse(msg);\n            console.log(data);\n\n            window.obstacles.deleteIfExists(data.id);\n        } else if (topic == TOPIC_OBSTACLES_DELETE_ALL) {\n            // Delete all obstacles\n            window.obstacles.deleteAll();\n        } else if (topic == TOPIC_CHANGE_COLOR) {\n            try {\n                const data = JSON.parse(msg);\n                window.robot.changeColor(data.id, data.R, data.G, data.B, data.ambient);\n            } catch (e) {\n                console.error(e);\n            }\n        } else if (topic == TOPIC_ROBOT_BROADCAST) {\n            // Display a popup message\n            // TODO: Do this by a generalized function call\n\n            if (msg != 'ID? -1') {\n                const m = 'Broadcast Message: ' + msg.split(' ')[0];\n                const t = 1000 + msg.length * 95;\n\n                let disp = document.querySelector('#msg-box');\n                disp.innerHTML = m;\n                disp.style.display = 'block';\n\n                setTimeout(function () {\n                    document.querySelector('#msg-box').style.display = 'none';\n                }, t);\n            }\n        } else if (topic == TOPIC_MANAGEMENT_VISUALIZER) {\n            if (msg === 'REFRESH') {\n                console.log('page refresh request');\n                location.reload();\n            } else if (msg.startsWith('MSG')) {\n                const m = 'Notice: ' + msg.substring(4);\n                const t = 2000 + m.length * 95;\n\n                // Display a popup message\n                // TODO: Do this by a generalized function call\n                let disp = document.querySelector('#msg-box');\n                disp.innerHTML = m;\n                disp.style.display = 'block';\n\n                setTimeout(function () {\n                    document.querySelector('#msg-box').style.display = 'none';\n                }, t);\n            } else {\n                console.log('>Management:', msg);\n            }\n        } else if (topic == TOPIC_MANAGEMENT_SNAPSHOT) {\n            const snapshot = JSON.parse(msg);\n\n            // TODO: @luk3Sky, can you refer the updates on simulator ?\n            console.log('Robot:Snapshot', snapshot);\n\n            const { reality, coordinates, data } = snapshot;\n\n            if (snapshot !== -1) {\n                let i = 0,\n                    subElement;\n                let disp = document.querySelector('#msg-box');\n                for (let variable in snapshot) {\n                    // Commented\n                    // Build Error on GH Actions\n                    // Do not access Object.prototype method 'hasOwnProperty' from target object\n                    // if (snapshot.hasOwnProperty(variable)) {\n                    //     if (i === 0) {\n                    //         subElement = document.createElement('h4');\n                    //     } else {\n                    //         subElement = document.createElement('p');\n                    //     }\n                    //     subElement.textContent = `${variable}: ${JSON.stringify(snapshot[variable])}`;\n                    //     // console.log(`${variable}: ${JSON.stringify(snapshot[variable])}`);\n                    //     disp.appendChild(subElement);\n                    //     i += 1;\n                    // }\n                }\n                disp.style.display = 'block';\n                disp.style.opacity = '0.5';\n                setTimeout(function () {\n                    document.querySelector('#msg-box').style.display = '1.0';\n                    document.querySelector('#msg-box').style.display = 'none';\n                    disp.style.opacity = '1.0';\n                }, 6000);\n            }\n        }\n    }\n\n    subscribe(topic, callback) {\n        const subTopic = window.channel + '/' + topic;\n        this.client.subscribe(subTopic);\n        console.log('MQTT: subscribed', subTopic);\n        if (callback != null) callback();\n    }\n\n    publish(topic, message, callback) {\n        var payload = new MQTT.Message(message);\n        const pubTopic = window.channel + '/' + topic;\n        payload.destinationName = pubTopic;\n        this.client.send(payload);\n        console.log('MQTT: published', pubTopic);\n\n        if (callback != null) callback();\n    }\n}\n","// Global imports -\nimport * as THREE from 'three';\n\nimport TWEEN, { update } from '@tweenjs/tween.js';\n\n// Components\nimport Renderer from './components/renderer';\nimport label from './components/label';\nimport Camera from './components/camera';\nimport Light from './components/light';\nimport Controls from './components/controls';\nimport Geometry from './components/geometry';\nimport Environment from './components/environment';\n\n// Helpers\nimport MeshHelper from './helpers/meshHelper';\n\n// Model\nimport Texture from './model/texture';\nimport Model from './model/model';\n\n// Managers\nimport Interaction from './managers/interaction';\nimport DatGUI from './managers/datGUI';\n\n// Newly implemented classes\nimport MQTTClient from './managers/mqttClient';\n\n// Config data\nimport Config from './../data/config';\n\n// STLLoader\nlet STLLoader = require('three-stl-loader')(THREE);\n\n// Global Variables\nlet camera, labelRenderer, INTERSECTED, selectedLabel;\n\n// For click event on robots\nlet raycaster = new THREE.Raycaster();\nconst mouse = new THREE.Vector2();\n\n// This class instantiates and ties all of the components together, starts the loading process and renders the main loop\nexport default class Main {\n    constructor(container) {\n        // Set container property to container element\n        this.container = container;\n\n        // Start Three clock\n        this.clock = new THREE.Clock();\n\n        // Main scene creation\n        this.scene = new THREE.Scene();\n        window.scene = this.scene; // config as a global variable\n        window.scene_scale = Config.scale;\n        // High level reality flag\n        window.selectedReality = Config.selectedReality;\n\n        this.scene.fog = new THREE.FogExp2(Config.fog.color, Config.fog.near);\n\n        this.mqtt = new MQTTClient(this.scene);\n\n        // Get Device Pixel Ratio first for retina\n        if (window.devicePixelRatio) {\n            Config.dpr = window.devicePixelRatio;\n        }\n\n        // Main renderer constructor\n        this.renderer = new Renderer(this.scene, container);\n\n        // Components instantiations\n        camera = new Camera(this.renderer.threeRenderer);\n        this.controls = new Controls(camera.threeCamera, container);\n        this.light = new Light(this.scene);\n        this.camera = camera;\n        // Create and place lights in scene\n        const lights = ['ambient', 'directional', 'point', 'hemi'];\n        lights.forEach((light) => this.light.place(light));\n\n        // Set up Stats if dev environment\n        if (Config.isDev && Config.isShowingStats) {\n            this.stats = new Stats();\n            this.container.appendChild(this.stats.dom);\n        }\n\n        if (Config.isShowingLables) {\n            this.labelRenderer = label();\n            this.container.appendChild(this.labelRenderer.domElement);\n        }\n\n        // Set up gui\n        if (Config.isDev) {\n            this.gui = new DatGUI(this);\n        }\n\n        // Instantiate texture class\n        this.texture = new Texture();\n\n        // Start loading the textures and then go on to load the model after the texture Promises have resolved\n        this.texture.load().then(() => {\n            this.manager = new THREE.LoadingManager();\n\n            // Create the environment ---------------------------------------------\n            this.environment = new Environment();\n\n            // -----------------------------------------------------------------\n\n            if (Config.isDev) {\n                // this.meshHelper = new MeshHelper(this.scene, this.model.obj);\n                //\n                // if (Config.mesh.enableHelper) this.meshHelper.enable();\n\n                this.gui.load(this);\n                console.log('gui:', this.gui);\n                this.gui.show();\n            }\n            // -----------------------------------------------------------------\n\n            // onProgress callback\n            this.manager.onProgress = (item, loaded, total) => {\n                console.log(`${item}: ${loaded} ${total}`);\n            };\n\n            // All loaders done now\n            this.manager.onLoad = () => {\n                // alert('Loaded');\n                console.log('Loading complete!');\n\n                // Set up interaction manager with the app now that the model is finished loading\n                new Interaction(\n                    this.renderer.threeRenderer,\n                    this.scene,\n                    camera.threeCamera,\n                    this.controls.threeControls\n                );\n\n                // Add dat.GUI controls if dev\n                if (Config.isDev) {\n                    this.meshHelper = new MeshHelper(this.scene, this.model.obj);\n\n                    if (Config.mesh.enableHelper) this.meshHelper.enable();\n\n                    // this.gui.load(this, this.model.obj);\n                    console.log('gui:', this.gui);\n                    // this.gui.show();\n                }\n\n                // Everything is now fully loaded\n                Config.isLoaded = true;\n                this.container.querySelector('#loading').style.display = 'none';\n            };\n        });\n\n        // Start render which does not wait for model fully loaded\n\n        this.render();\n        this.container.querySelector('#loading').style.display = 'none';\n\n        // Eventlistner for catching mouse click events\n        window.addEventListener('click', this.onDocumentMouseDown, false);\n        // Eventlistner for catching mouse move events\n        // document.addEventListener('mousemove', this.onDocumentMouseMove);\n    }\n\n    onDocumentMouseDown(event) {\n        event.preventDefault();\n\n        mouse.x = (event.clientX / window.innerWidth) * 2 - 1;\n        mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;\n\n        raycaster.setFromCamera(mouse, camera.threeCamera);\n\n        const intersects = raycaster.intersectObjects(scene.children);\n        if (intersects.length > 0) {\n            let object = intersects[0].object;\n            if (INTERSECTED) INTERSECTED.material.setValues({ opacity: INTERSECTED.currentOpacity });\n            INTERSECTED = object;\n            selectedLabel = INTERSECTED.children[0];\n            INTERSECTED.currentOpacity = INTERSECTED.material.opacity;\n            INTERSECTED.labelsVisibility = INTERSECTED.material.labelVisibility;\n            if (selectedLabel !== undefined && selectedLabel.visible !== undefined && Config.isShowingLables) {\n                selectedLabel.visible = !selectedLabel.visible;\n            }\n            INTERSECTED.material.selected = !INTERSECTED.material.selected;\n            if (INTERSECTED.name.startsWith('Obstacle')) {\n                if (INTERSECTED.material.selected) {\n                    INTERSECTED.currentHex = INTERSECTED.material.emissive.getHex();\n                    INTERSECTED.material.emissive.setHex(0xf95f4a);\n                } else {\n                    INTERSECTED.currentHex = INTERSECTED.material.userData.originalEmmisive;\n                    INTERSECTED.material.emissive.setHex(INTERSECTED.currentHex);\n                }\n            } else if (INTERSECTED.name.startsWith('Robot')) {\n                if (INTERSECTED.material.selected) {\n                    INTERSECTED.material.setValues({ opacity: 0.5 });\n                } else {\n                    INTERSECTED.material.setValues({ opacity: 1 });\n                }\n                if (INTERSECTED.clickEvent !== undefined) {\n                    INTERSECTED.clickEvent(INTERSECTED);\n                }\n            }\n        } else {\n            if (INTERSECTED) INTERSECTED.material.setValues({ opacity: INTERSECTED.currentOpacity });\n            INTERSECTED = null;\n        }\n    }\n\n    onDocumentMouseMove(event) {\n        event.preventDefault();\n\n        mouse.x = (event.clientX / window.innerWidth) * 2 - 1;\n        mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;\n\n        raycaster.setFromCamera(mouse, camera.threeCamera);\n\n        const intersects = raycaster.intersectObjects(scene.children, true);\n        if (intersects.length > 0) {\n            let object = intersects[0].object;\n            if (INTERSECTED !== object) {\n                if (INTERSECTED) INTERSECTED.material.setValues({ opacity: INTERSECTED.currentOpacity });\n                INTERSECTED = object;\n                selectedLabel = INTERSECTED.children[0];\n                INTERSECTED.currentOpacity = INTERSECTED.material.opacity;\n                INTERSECTED.currentColor = INTERSECTED.material.opacity;\n                INTERSECTED.material.setValues({ color: 0x03dffc, opacity: 0.75 });\n            }\n        } else {\n            if (INTERSECTED)\n                INTERSECTED.material.setValues({ opacity: 1.0, color: INTERSECTED.material.userData.originalColor });\n            INTERSECTED = null;\n        }\n    }\n\n    render() {\n        // Call render function and pass in created scene and camera\n        this.renderer.render(this.scene, camera.threeCamera);\n\n        // render labels if enabled\n        if (Config.isShowingLables && this.labelRenderer.isShowingLables) {\n            this.labelRenderer.domElement.hidden = false;\n            this.labelRenderer.render(this.scene, camera.threeCamera);\n        } else {\n            this.labelRenderer.domElement.hidden = true;\n        }\n\n        // Delta time is sometimes needed for certain updates\n        //const delta = this.clock.getDelta();\n\n        // Call any vendor or module frame updates here\n        TWEEN.update();\n        this.controls.threeControls.update();\n\n        camera.threeCamera.updateMatrixWorld();\n\n        // update stats if dev environment\n        if (Config.isDev && Config.isShowingStats) {\n            this.stats.update();\n        }\n\n        // RAF\n        requestAnimationFrame(this.render.bind(this)); // Bind the main class instead of window object\n    }\n}\n","import Config from './data/config';\nimport Detector from './utils/detector';\nimport Main from './app/main';\n\n// Styles\nimport './../css/app.scss';\n// Check environment and set the Config helper\nif (__ENV__ === 'dev') {\n    console.log('----- RUNNING IN DEV ENVIRONMENT! -----');\n    Config.isDev = true;\n}\n\nfunction init() {\n    // Check for webGL capabilities\n    if (!Detector.webgl) {\n        Detector.addGetWebGLMessage();\n    } else {\n        const container = document.getElementById('appContainer');\n        new Main(container);\n    }\n}\n\ninit();\n"],"sourceRoot":""}